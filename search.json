[
  {
    "objectID": "variant_calling.html",
    "href": "variant_calling.html",
    "title": "Variant calling",
    "section": "",
    "text": "Now that we have quality-controlled the BAM files, we can go ahead with somatic variant calling.\n\n\n\n\n\n\nNoteSomatic vs Germline Variant Calling\n\n\n\nSomatic variant calling differs from germline calling in several key ways:\n\nTumor-normal pairs: We compare tumor against matched normal to identify somatic (tumor-only) variants\nLower allele frequencies: Somatic variants may be present in only a subset of tumor cells (subclonal)\nArtifacts: Sequencing/alignment artifacts can mimic somatic variants, requiring careful filtering\nStatistical challenge: Distinguishing true low-frequency somatic variants from noise\n\nThis is why we need specialized tools like Mutect2 rather than standard germline callers.\n\n\nFor this, we use Mutect2 which is a somatic variant caller from the GATK toolkit. In addition to the expected bam files and references genome, Mutect2 requires some additional input:\n\n--intervals: the intervals of our target regions. This is in the interval_list format.\n-normal: the sample name of the normal sample. So, the SM tag of the read group of the normal sample.\n--germline-resource: known sites of germline variants with their allele frequencies in the population. These are used to estimate the confidence of a germline variant in the normal sample.\n--panel-of-normals: A VCF generated from normal samples that contain sites with known technical artifacts. Ideally, you create a PON from your own normal samples, but this is typically recommended if you have more than 40 normal samples. Therefore, here, we use a pre-generated PON from the 1000 genomes project. More information on PON in this article.\n\n\n\n\n\n\n\nImportantExercise 1\n\n\n\nCreate a script called 03_run_mutect2.sh. After that, check out the manual of Mutect2 and replace the placeholders FIXME with the required values of the Mutect2 below command and run it:\n\n#!/usr/bin/env bash\n\nALIGNDIR=~/project/course_data/alignments\nREFDIR=~/project/course_data/reference\nRESOURCEDIR=~/project/course_data/resources\nVARIANTDIR=~/project/course_data/variants\n\nmkdir -p $VARIANTDIR\n\ngatk Mutect2 \\\n-R FIXME \\\n--intervals \"$REFDIR\"/exome_regions.bed.interval_list \\\n-I FIXME \\\n-I FIXME \\\n-normal FIXME \\\n--germline-resource \"$RESOURCEDIR\"/af-only-gnomad.hg38.subset.vcf.gz \\\n--panel-of-normals \"$RESOURCEDIR\"/1000g_pon.hg38.subset.vcf.gz \\\n-O \"$VARIANTDIR\"/somatic.vcf.gz\n\n\n\n\n\n\n\n\nCaution\n\n\n\nThis takes a while to run. Have a break!\n\n\n\n\n\n\n\n\nTipAnswer\n\n\n\n\n\n#!/usr/bin/env bash\n\nALIGNDIR=~/project/course_data/alignments\nREFDIR=~/project/course_data/reference\nRESOURCEDIR=~/project/course_data/resources\nVARIANTDIR=~/project/course_data/variants\n\nmkdir -p $VARIANTDIR\n\ngatk Mutect2 \\\n-R \"$REFDIR\"/ref_genome.fa \\\n--intervals \"$REFDIR\"/exome_regions.bed.interval_list \\\n-I \"$ALIGNDIR\"/tumor.recal.bam \\\n-I \"$ALIGNDIR\"/normal.recal.bam \\\n-normal normal \\\n--germline-resource \"$RESOURCEDIR\"/af-only-gnomad.hg38.subset.vcf.gz \\\n--panel-of-normals \"$RESOURCEDIR\"/1000g_pon.hg38.subset.vcf.gz \\\n-O \"$VARIANTDIR\"/somatic.vcf.gz\nNotes\n\n-normal: comes from the read group in the bam files (SM tag)\n--germline-resource: A VCF of known germline variants from large population studies (gnomAD, 1000 Genomes)\n--panel-of-normals: These are NOT real biological variants - they’re sequencing/alignment errors (ideally from &gt;40-100 normal samples from the same cohort)\n\n\n\n\nAfter calling the variants we can do an initial filtering step. We do this with FilterMutectCalls. This method takes technical artifacts, possibility of germline variants, and sequencing error in account, calculates an error probability and tries to optimize between recall and precision.\n\n\n\n\n\n\nImportantExercise 2\n\n\n\nCreate a script called 04_filter_mutect_calls.sh in ~/project/scripts. From the script, run the command to filter the somatic variants:\n#!/usr/bin/env bash\n\nREFDIR=~/project/course_data/reference\nVARIANTDIR=~/project/course_data/variants\n\n# fill the filter column\ngatk FilterMutectCalls \\\n-R \"$REFDIR\"/ref_genome.fa \\\n-V \"$VARIANTDIR\"/somatic.vcf.gz \\\n-O \"$VARIANTDIR\"/somatic.filtered.vcf.gz\n\n# create a vcf with variants passing filters (PASS)\nbcftools view -f PASS \"$VARIANTDIR\"/somatic.filtered.vcf.gz -Oz \\\n&gt; \"$VARIANTDIR\"/somatic.filtered.PASS.vcf.gz\n\nbcftools index --tbi \"$VARIANTDIR\"/somatic.filtered.PASS.vcf.gz\nHow many variants were kept? What were the main reason for filtering them out?\n\n\n\n\n\n\n\n\nNote\n\n\n\nThe filtering information is in the 7th column of the vcf, so you can do something like:\nbcftools view -H my_variants.vcf.gz | cut -f 7 | sort | uniq -c | sort -nr | head -n 10\n\n\n\n\n\n\n\n\nTipAnswer\n\n\n\n\n\nTo get the number of variants in the unfiltered vcf:\nbcftools view -H somatic.vcf.gz | wc -l\nResulting in 467 unfiltered variants.\nTo get the 10 most frequently occurring filters in the filter column of the filtered vcf:\nbcftools view -H somatic.filtered.vcf.gz | cut -f 7 | sort | uniq -c | sort -nr | head -n 10\nResulting in:\n133 PASS\n48 weak_evidence\n26 normal_artifact;strand_bias\n21 panel_of_normals\n17 normal_artifact\n13 normal_artifact;slippage;weak_evidence\n13 clustered_events;normal_artifact;strand_bias\n12 germline;multiallelic;normal_artifact;panel_of_normals\n12 base_qual;normal_artifact;strand_bias\n9 strand_bias;weak_evidence\nSo most variants were filtered out, and most of the variants were filtered out because of ‘weak evidence’.\nIn order to figure out what that means we can check out the vcf header:\nbcftools view -h somatic.filtered.vcf.gz | grep \"^##FILTER\"\nResulting in:\n##FILTER=&lt;ID=FAIL,Description=\"Fail the site if all alleles fail but for different reasons.\"&gt;\n##FILTER=&lt;ID=PASS,Description=\"Site contains at least one allele that passes filters\"&gt;\n##FILTER=&lt;ID=base_qual,Description=\"alt median base quality\"&gt;\n##FILTER=&lt;ID=clustered_events,Description=\"Clustered events observed in the tumor\"&gt;\n##FILTER=&lt;ID=contamination,Description=\"contamination\"&gt;\n##FILTER=&lt;ID=duplicate,Description=\"evidence for alt allele is overrepresented by apparent duplicates\"&gt;\n##FILTER=&lt;ID=fragment,Description=\"abs(ref - alt) median fragment length\"&gt;\n##FILTER=&lt;ID=germline,Description=\"Evidence indicates this site is germline, not somatic\"&gt;\n##FILTER=&lt;ID=haplotype,Description=\"Variant near filtered variant on same haplotype.\"&gt;\n##FILTER=&lt;ID=low_allele_frac,Description=\"Allele fraction is below specified threshold\"&gt;\n##FILTER=&lt;ID=map_qual,Description=\"ref - alt median mapping quality\"&gt;\n##FILTER=&lt;ID=multiallelic,Description=\"Site filtered because too many alt alleles pass tumor LOD\"&gt;\n##FILTER=&lt;ID=n_ratio,Description=\"Ratio of N to alt exceeds specified ratio\"&gt;\n##FILTER=&lt;ID=normal_artifact,Description=\"artifact_in_normal\"&gt;\n##FILTER=&lt;ID=orientation,Description=\"orientation bias detected by the orientation bias mixture model\"&gt;\n##FILTER=&lt;ID=panel_of_normals,Description=\"Blacklisted site in panel of normals\"&gt;\n##FILTER=&lt;ID=position,Description=\"median distance of alt variants from end of reads\"&gt;\n##FILTER=&lt;ID=possible_numt,Description=\"Allele depth is below expected coverage of NuMT in autosome\"&gt;\n##FILTER=&lt;ID=slippage,Description=\"Site filtered due to contraction of short tandem repeat region\"&gt;\n##FILTER=&lt;ID=strand_bias,Description=\"Evidence for alt allele comes from one read direction only\"&gt;\n##FILTER=&lt;ID=strict_strand,Description=\"Evidence for alt allele is not represented in both directions\"&gt;\n##FILTER=&lt;ID=weak_evidence,Description=\"Mutation does not meet likelihood threshold\"&gt;\nShowing us that these mutations do not meet the likelihood threshold, basically telling us that these are the variants filtered out because of the combined error probability based on technical artifacts, possibility of germline variants, and sequencing error. The other filters are so called ‘hard filters’, meaning that by themselves they do not meet a fixed threshold.\n\n\n\n\n\n\n\n\n\n\n\nCautionOnly when you have time\n\n\n\nDo the exercises about summarizing the VCF only if you have time. Otherwise, continue to Copy number variation calling.\n\n\nLet’s check out the VCF in a bit more detail. We’d like to have an idea what kind of variants are in there, and what for example their variant allele frequency is.\nFirst, we can check what the variants look like:\nbcftools view -H somatic.filtered.vcf.gz | head\nShowing us that both the FORMAT and INFO fields are filled with information. To check out the meaning of what is in the INFO field you can run:\nbcftools view -h somatic.filtered.vcf.gz | grep \"^##INFO\"\nAnd you can do the same for the format fields:\nbcftools view -h somatic.filtered.vcf.gz | grep \"^##FORMAT\"\nTo summarize the vcf for information in the format or info fields you can use bcftools query. For example, for getting the likelihood of variant and depth of each sample, you can do the following (for the first 20 variants):\nbcftools query -f '%CHROM\\t%POS\\t%FILTER\\t\\t%INFO/TLOD\\t[%SAMPLE=%DP;]\\n' somatic.filtered.vcf.gz | head -20\n\n\n\n\n\n\nImportantExercise 3\n\n\n\nInstead of the depth DP for each sample get the variant allele frequency for each sample, and compare that with the FILTER column.\n\n\n\n\n\n\n\n\nTipAnswer\n\n\n\n\n\nWe can check which tag contains the variant allele frequency in the vcf:\nbcftools view -h somatic.filtered.vcf.gz | grep \"^##FORMAT\"\nReturning:\n##FORMAT=&lt;ID=AD,Number=R,Type=Integer,Description=\"Allelic depths for the ref and alt alleles in the order listed\"&gt;\n##FORMAT=&lt;ID=AF,Number=A,Type=Float,Description=\"Allele fractions of alternate alleles in the tumor\"&gt;\n##FORMAT=&lt;ID=DP,Number=1,Type=Integer,Description=\"Approximate read depth (reads with MQ=255 or with bad mates are filtered)\"&gt;\n##FORMAT=&lt;ID=F1R2,Number=R,Type=Integer,Description=\"Count of reads in F1R2 pair orientation supporting each allele\"&gt;\n##FORMAT=&lt;ID=F2R1,Number=R,Type=Integer,Description=\"Count of reads in F2R1 pair orientation supporting each allele\"&gt;\n##FORMAT=&lt;ID=FAD,Number=R,Type=Integer,Description=\"Count of fragments supporting each allele.\"&gt;\n##FORMAT=&lt;ID=GQ,Number=1,Type=Integer,Description=\"Genotype Quality\"&gt;\n##FORMAT=&lt;ID=GT,Number=1,Type=String,Description=\"Genotype\"&gt;\n##FORMAT=&lt;ID=PGT,Number=1,Type=String,Description=\"Physical phasing haplotype information, describing how the alternate alleles are phased in relation to one another; will always be heterozygous and is not intended to describe called alleles\"&gt;\n##FORMAT=&lt;ID=PID,Number=1,Type=String,Description=\"Physical phasing ID information, where each unique ID within a given sample (but not across samples) connects records within a phasing group\"&gt;\n##FORMAT=&lt;ID=PL,Number=G,Type=Integer,Description=\"Normalized, Phred-scaled likelihoods for genotypes as defined in the VCF specification\"&gt;\n##FORMAT=&lt;ID=PS,Number=1,Type=Integer,Description=\"Phasing set (typically the position of the first variant in the set)\"&gt;\n##FORMAT=&lt;ID=SB,Number=4,Type=Integer,Description=\"Per-sample component statistics which comprise the Fisher's Exact Test to detect strand bias.\"&gt;\nWhere AF contains ‘Allele fractions of alternate alleles in the tumor’, so that is the tag we are looking for. So, we replace DP with AF:\nbcftools query -f '%CHROM\\t%POS\\t%FILTER\\t\\t%INFO/TLOD\\t[%SAMPLE=%AF;]\\n' somatic.filtered.vcf.gz | head -30\nReturning:\nchr6    106265  map_qual;strand_bias;weak_evidence              3.99    normal=0.00671;tumor=0.01;\nchr6    325357  PASS            719.91  normal=0.001054;tumor=0.161;\nchr6    325783  PASS            1292.31 normal=0.0009626;tumor=0.224;\nchr6    325901  PASS            1030.6  normal=0.005447;tumor=0.183;\nchr6    325916  PASS            937.7   normal=0.004142;tumor=0.116;\nchr6    1742560 panel_of_normals                235.6   normal=0.02;tumor=0.41;\nchr6    1916336 PASS            187.23  normal=0.022;tumor=0.482;\nchr6    1930220 PASS            152.54  normal=0.016;tumor=0.207;\nchr6    2674999 PASS            190.32  normal=0.028;tumor=0.514;\nchr6    2834013 PASS            245.04  normal=0.02;tumor=0.494;\nchr6    2840548 PASS            274.4   normal=0.021;tumor=0.522;\nchr6    3110986 weak_evidence           3.03    normal=0.017;tumor=0.019;\nchr6    3723708 PASS            266.67  normal=0.017;tumor=0.42;\nchr6    4892169 weak_evidence           4.43    normal=0.024;tumor=0.02;\nchr6    5103987 germline;multiallelic;normal_artifact;panel_of_normals          13.57,257.27    normal=0.037,0.825;tumor=0.077,0.834;\nchr6    6250887 PASS            260.99  normal=0.018;tumor=0.459;\nchr6    7176847 PASS            107.39  normal=0.026;tumor=0.319;\nchr6    7585458 PASS            171.88  normal=0.015;tumor=0.283;\nchr6    7833697 PASS            122.24  normal=0.057;tumor=0.513;\nchr6    7883281 germline                99.5    normal=0.05;tumor=0.476;\nchr6    8054329 PASS            420.89  normal=0.045;tumor=0.446;\nchr6    9900366 panel_of_normals                525.07  normal=0.024;tumor=0.992;\nchr6    10397660        germline;multiallelic;slippage          3.21,50.94      normal=0.042,0.043;tumor=0.098,0.798;\nchr6    10398435        PASS            365.76  normal=0.013;tumor=0.943;\nchr6    10801908        PASS            91.41   normal=0.02;tumor=0.312;\nchr6    10989772        PASS            71.25   normal=0.041;tumor=0.49;\nchr6    11306007        PASS            209.24  normal=0.009359;tumor=0.4;\nchr6    13479062        germline;multiallelic;normal_artifact;panel_of_normals          4.63,5.86,13.96 normal=0.022,0.027,0.258;tumor=0.043,0.068,0.165;\nchr6    13977507        weak_evidence           3.4     normal=0.012;tumor=0.027;\nchr6    16147945        PASS            331.72  normal=0.014;tumor=0.978;\nWhere we see that if there’s the filter weak_evidence the VAF of the tumor is typically low.\nKey observations:\n\nPASS variants typically have:\n\nTumor VAF &gt;0.15 (15%)\nLow/zero VAF in normal (&lt;0.03)\nExample: chr6:325357 has tumor=0.161, normal=0.001\n\nweak_evidence variants show:\n\nVery low tumor VAF (&lt;0.05)\nNear the detection limit\nExample: chr6:106265 has tumor=0.01, normal=0.00671\n\ngermline tagged variants:\n\nSimilar VAF in both tumor and normal\nExample: chr6:5103987 has normal=0.825, tumor=0.834 (very similar)\nThese are inherited variants, not somatic\n\npanel_of_normals filtered variants:\n\nMay have high VAF but appear in technical artifact database\nExample: chr6:9900366 has very high tumor VAF (0.992) but filtered"
  },
  {
    "objectID": "variant_calling.html#short-variant-calling",
    "href": "variant_calling.html#short-variant-calling",
    "title": "Variant calling",
    "section": "",
    "text": "Now that we have quality-controlled the BAM files, we can go ahead with somatic variant calling.\n\n\n\n\n\n\nNoteSomatic vs Germline Variant Calling\n\n\n\nSomatic variant calling differs from germline calling in several key ways:\n\nTumor-normal pairs: We compare tumor against matched normal to identify somatic (tumor-only) variants\nLower allele frequencies: Somatic variants may be present in only a subset of tumor cells (subclonal)\nArtifacts: Sequencing/alignment artifacts can mimic somatic variants, requiring careful filtering\nStatistical challenge: Distinguishing true low-frequency somatic variants from noise\n\nThis is why we need specialized tools like Mutect2 rather than standard germline callers.\n\n\nFor this, we use Mutect2 which is a somatic variant caller from the GATK toolkit. In addition to the expected bam files and references genome, Mutect2 requires some additional input:\n\n--intervals: the intervals of our target regions. This is in the interval_list format.\n-normal: the sample name of the normal sample. So, the SM tag of the read group of the normal sample.\n--germline-resource: known sites of germline variants with their allele frequencies in the population. These are used to estimate the confidence of a germline variant in the normal sample.\n--panel-of-normals: A VCF generated from normal samples that contain sites with known technical artifacts. Ideally, you create a PON from your own normal samples, but this is typically recommended if you have more than 40 normal samples. Therefore, here, we use a pre-generated PON from the 1000 genomes project. More information on PON in this article.\n\n\n\n\n\n\n\nImportantExercise 1\n\n\n\nCreate a script called 03_run_mutect2.sh. After that, check out the manual of Mutect2 and replace the placeholders FIXME with the required values of the Mutect2 below command and run it:\n\n#!/usr/bin/env bash\n\nALIGNDIR=~/project/course_data/alignments\nREFDIR=~/project/course_data/reference\nRESOURCEDIR=~/project/course_data/resources\nVARIANTDIR=~/project/course_data/variants\n\nmkdir -p $VARIANTDIR\n\ngatk Mutect2 \\\n-R FIXME \\\n--intervals \"$REFDIR\"/exome_regions.bed.interval_list \\\n-I FIXME \\\n-I FIXME \\\n-normal FIXME \\\n--germline-resource \"$RESOURCEDIR\"/af-only-gnomad.hg38.subset.vcf.gz \\\n--panel-of-normals \"$RESOURCEDIR\"/1000g_pon.hg38.subset.vcf.gz \\\n-O \"$VARIANTDIR\"/somatic.vcf.gz\n\n\n\n\n\n\n\n\nCaution\n\n\n\nThis takes a while to run. Have a break!\n\n\n\n\n\n\n\n\nTipAnswer\n\n\n\n\n\n#!/usr/bin/env bash\n\nALIGNDIR=~/project/course_data/alignments\nREFDIR=~/project/course_data/reference\nRESOURCEDIR=~/project/course_data/resources\nVARIANTDIR=~/project/course_data/variants\n\nmkdir -p $VARIANTDIR\n\ngatk Mutect2 \\\n-R \"$REFDIR\"/ref_genome.fa \\\n--intervals \"$REFDIR\"/exome_regions.bed.interval_list \\\n-I \"$ALIGNDIR\"/tumor.recal.bam \\\n-I \"$ALIGNDIR\"/normal.recal.bam \\\n-normal normal \\\n--germline-resource \"$RESOURCEDIR\"/af-only-gnomad.hg38.subset.vcf.gz \\\n--panel-of-normals \"$RESOURCEDIR\"/1000g_pon.hg38.subset.vcf.gz \\\n-O \"$VARIANTDIR\"/somatic.vcf.gz\nNotes\n\n-normal: comes from the read group in the bam files (SM tag)\n--germline-resource: A VCF of known germline variants from large population studies (gnomAD, 1000 Genomes)\n--panel-of-normals: These are NOT real biological variants - they’re sequencing/alignment errors (ideally from &gt;40-100 normal samples from the same cohort)\n\n\n\n\nAfter calling the variants we can do an initial filtering step. We do this with FilterMutectCalls. This method takes technical artifacts, possibility of germline variants, and sequencing error in account, calculates an error probability and tries to optimize between recall and precision.\n\n\n\n\n\n\nImportantExercise 2\n\n\n\nCreate a script called 04_filter_mutect_calls.sh in ~/project/scripts. From the script, run the command to filter the somatic variants:\n#!/usr/bin/env bash\n\nREFDIR=~/project/course_data/reference\nVARIANTDIR=~/project/course_data/variants\n\n# fill the filter column\ngatk FilterMutectCalls \\\n-R \"$REFDIR\"/ref_genome.fa \\\n-V \"$VARIANTDIR\"/somatic.vcf.gz \\\n-O \"$VARIANTDIR\"/somatic.filtered.vcf.gz\n\n# create a vcf with variants passing filters (PASS)\nbcftools view -f PASS \"$VARIANTDIR\"/somatic.filtered.vcf.gz -Oz \\\n&gt; \"$VARIANTDIR\"/somatic.filtered.PASS.vcf.gz\n\nbcftools index --tbi \"$VARIANTDIR\"/somatic.filtered.PASS.vcf.gz\nHow many variants were kept? What were the main reason for filtering them out?\n\n\n\n\n\n\n\n\nNote\n\n\n\nThe filtering information is in the 7th column of the vcf, so you can do something like:\nbcftools view -H my_variants.vcf.gz | cut -f 7 | sort | uniq -c | sort -nr | head -n 10\n\n\n\n\n\n\n\n\nTipAnswer\n\n\n\n\n\nTo get the number of variants in the unfiltered vcf:\nbcftools view -H somatic.vcf.gz | wc -l\nResulting in 467 unfiltered variants.\nTo get the 10 most frequently occurring filters in the filter column of the filtered vcf:\nbcftools view -H somatic.filtered.vcf.gz | cut -f 7 | sort | uniq -c | sort -nr | head -n 10\nResulting in:\n133 PASS\n48 weak_evidence\n26 normal_artifact;strand_bias\n21 panel_of_normals\n17 normal_artifact\n13 normal_artifact;slippage;weak_evidence\n13 clustered_events;normal_artifact;strand_bias\n12 germline;multiallelic;normal_artifact;panel_of_normals\n12 base_qual;normal_artifact;strand_bias\n9 strand_bias;weak_evidence\nSo most variants were filtered out, and most of the variants were filtered out because of ‘weak evidence’.\nIn order to figure out what that means we can check out the vcf header:\nbcftools view -h somatic.filtered.vcf.gz | grep \"^##FILTER\"\nResulting in:\n##FILTER=&lt;ID=FAIL,Description=\"Fail the site if all alleles fail but for different reasons.\"&gt;\n##FILTER=&lt;ID=PASS,Description=\"Site contains at least one allele that passes filters\"&gt;\n##FILTER=&lt;ID=base_qual,Description=\"alt median base quality\"&gt;\n##FILTER=&lt;ID=clustered_events,Description=\"Clustered events observed in the tumor\"&gt;\n##FILTER=&lt;ID=contamination,Description=\"contamination\"&gt;\n##FILTER=&lt;ID=duplicate,Description=\"evidence for alt allele is overrepresented by apparent duplicates\"&gt;\n##FILTER=&lt;ID=fragment,Description=\"abs(ref - alt) median fragment length\"&gt;\n##FILTER=&lt;ID=germline,Description=\"Evidence indicates this site is germline, not somatic\"&gt;\n##FILTER=&lt;ID=haplotype,Description=\"Variant near filtered variant on same haplotype.\"&gt;\n##FILTER=&lt;ID=low_allele_frac,Description=\"Allele fraction is below specified threshold\"&gt;\n##FILTER=&lt;ID=map_qual,Description=\"ref - alt median mapping quality\"&gt;\n##FILTER=&lt;ID=multiallelic,Description=\"Site filtered because too many alt alleles pass tumor LOD\"&gt;\n##FILTER=&lt;ID=n_ratio,Description=\"Ratio of N to alt exceeds specified ratio\"&gt;\n##FILTER=&lt;ID=normal_artifact,Description=\"artifact_in_normal\"&gt;\n##FILTER=&lt;ID=orientation,Description=\"orientation bias detected by the orientation bias mixture model\"&gt;\n##FILTER=&lt;ID=panel_of_normals,Description=\"Blacklisted site in panel of normals\"&gt;\n##FILTER=&lt;ID=position,Description=\"median distance of alt variants from end of reads\"&gt;\n##FILTER=&lt;ID=possible_numt,Description=\"Allele depth is below expected coverage of NuMT in autosome\"&gt;\n##FILTER=&lt;ID=slippage,Description=\"Site filtered due to contraction of short tandem repeat region\"&gt;\n##FILTER=&lt;ID=strand_bias,Description=\"Evidence for alt allele comes from one read direction only\"&gt;\n##FILTER=&lt;ID=strict_strand,Description=\"Evidence for alt allele is not represented in both directions\"&gt;\n##FILTER=&lt;ID=weak_evidence,Description=\"Mutation does not meet likelihood threshold\"&gt;\nShowing us that these mutations do not meet the likelihood threshold, basically telling us that these are the variants filtered out because of the combined error probability based on technical artifacts, possibility of germline variants, and sequencing error. The other filters are so called ‘hard filters’, meaning that by themselves they do not meet a fixed threshold.\n\n\n\n\n\n\n\n\n\n\n\nCautionOnly when you have time\n\n\n\nDo the exercises about summarizing the VCF only if you have time. Otherwise, continue to Copy number variation calling.\n\n\nLet’s check out the VCF in a bit more detail. We’d like to have an idea what kind of variants are in there, and what for example their variant allele frequency is.\nFirst, we can check what the variants look like:\nbcftools view -H somatic.filtered.vcf.gz | head\nShowing us that both the FORMAT and INFO fields are filled with information. To check out the meaning of what is in the INFO field you can run:\nbcftools view -h somatic.filtered.vcf.gz | grep \"^##INFO\"\nAnd you can do the same for the format fields:\nbcftools view -h somatic.filtered.vcf.gz | grep \"^##FORMAT\"\nTo summarize the vcf for information in the format or info fields you can use bcftools query. For example, for getting the likelihood of variant and depth of each sample, you can do the following (for the first 20 variants):\nbcftools query -f '%CHROM\\t%POS\\t%FILTER\\t\\t%INFO/TLOD\\t[%SAMPLE=%DP;]\\n' somatic.filtered.vcf.gz | head -20\n\n\n\n\n\n\nImportantExercise 3\n\n\n\nInstead of the depth DP for each sample get the variant allele frequency for each sample, and compare that with the FILTER column.\n\n\n\n\n\n\n\n\nTipAnswer\n\n\n\n\n\nWe can check which tag contains the variant allele frequency in the vcf:\nbcftools view -h somatic.filtered.vcf.gz | grep \"^##FORMAT\"\nReturning:\n##FORMAT=&lt;ID=AD,Number=R,Type=Integer,Description=\"Allelic depths for the ref and alt alleles in the order listed\"&gt;\n##FORMAT=&lt;ID=AF,Number=A,Type=Float,Description=\"Allele fractions of alternate alleles in the tumor\"&gt;\n##FORMAT=&lt;ID=DP,Number=1,Type=Integer,Description=\"Approximate read depth (reads with MQ=255 or with bad mates are filtered)\"&gt;\n##FORMAT=&lt;ID=F1R2,Number=R,Type=Integer,Description=\"Count of reads in F1R2 pair orientation supporting each allele\"&gt;\n##FORMAT=&lt;ID=F2R1,Number=R,Type=Integer,Description=\"Count of reads in F2R1 pair orientation supporting each allele\"&gt;\n##FORMAT=&lt;ID=FAD,Number=R,Type=Integer,Description=\"Count of fragments supporting each allele.\"&gt;\n##FORMAT=&lt;ID=GQ,Number=1,Type=Integer,Description=\"Genotype Quality\"&gt;\n##FORMAT=&lt;ID=GT,Number=1,Type=String,Description=\"Genotype\"&gt;\n##FORMAT=&lt;ID=PGT,Number=1,Type=String,Description=\"Physical phasing haplotype information, describing how the alternate alleles are phased in relation to one another; will always be heterozygous and is not intended to describe called alleles\"&gt;\n##FORMAT=&lt;ID=PID,Number=1,Type=String,Description=\"Physical phasing ID information, where each unique ID within a given sample (but not across samples) connects records within a phasing group\"&gt;\n##FORMAT=&lt;ID=PL,Number=G,Type=Integer,Description=\"Normalized, Phred-scaled likelihoods for genotypes as defined in the VCF specification\"&gt;\n##FORMAT=&lt;ID=PS,Number=1,Type=Integer,Description=\"Phasing set (typically the position of the first variant in the set)\"&gt;\n##FORMAT=&lt;ID=SB,Number=4,Type=Integer,Description=\"Per-sample component statistics which comprise the Fisher's Exact Test to detect strand bias.\"&gt;\nWhere AF contains ‘Allele fractions of alternate alleles in the tumor’, so that is the tag we are looking for. So, we replace DP with AF:\nbcftools query -f '%CHROM\\t%POS\\t%FILTER\\t\\t%INFO/TLOD\\t[%SAMPLE=%AF;]\\n' somatic.filtered.vcf.gz | head -30\nReturning:\nchr6    106265  map_qual;strand_bias;weak_evidence              3.99    normal=0.00671;tumor=0.01;\nchr6    325357  PASS            719.91  normal=0.001054;tumor=0.161;\nchr6    325783  PASS            1292.31 normal=0.0009626;tumor=0.224;\nchr6    325901  PASS            1030.6  normal=0.005447;tumor=0.183;\nchr6    325916  PASS            937.7   normal=0.004142;tumor=0.116;\nchr6    1742560 panel_of_normals                235.6   normal=0.02;tumor=0.41;\nchr6    1916336 PASS            187.23  normal=0.022;tumor=0.482;\nchr6    1930220 PASS            152.54  normal=0.016;tumor=0.207;\nchr6    2674999 PASS            190.32  normal=0.028;tumor=0.514;\nchr6    2834013 PASS            245.04  normal=0.02;tumor=0.494;\nchr6    2840548 PASS            274.4   normal=0.021;tumor=0.522;\nchr6    3110986 weak_evidence           3.03    normal=0.017;tumor=0.019;\nchr6    3723708 PASS            266.67  normal=0.017;tumor=0.42;\nchr6    4892169 weak_evidence           4.43    normal=0.024;tumor=0.02;\nchr6    5103987 germline;multiallelic;normal_artifact;panel_of_normals          13.57,257.27    normal=0.037,0.825;tumor=0.077,0.834;\nchr6    6250887 PASS            260.99  normal=0.018;tumor=0.459;\nchr6    7176847 PASS            107.39  normal=0.026;tumor=0.319;\nchr6    7585458 PASS            171.88  normal=0.015;tumor=0.283;\nchr6    7833697 PASS            122.24  normal=0.057;tumor=0.513;\nchr6    7883281 germline                99.5    normal=0.05;tumor=0.476;\nchr6    8054329 PASS            420.89  normal=0.045;tumor=0.446;\nchr6    9900366 panel_of_normals                525.07  normal=0.024;tumor=0.992;\nchr6    10397660        germline;multiallelic;slippage          3.21,50.94      normal=0.042,0.043;tumor=0.098,0.798;\nchr6    10398435        PASS            365.76  normal=0.013;tumor=0.943;\nchr6    10801908        PASS            91.41   normal=0.02;tumor=0.312;\nchr6    10989772        PASS            71.25   normal=0.041;tumor=0.49;\nchr6    11306007        PASS            209.24  normal=0.009359;tumor=0.4;\nchr6    13479062        germline;multiallelic;normal_artifact;panel_of_normals          4.63,5.86,13.96 normal=0.022,0.027,0.258;tumor=0.043,0.068,0.165;\nchr6    13977507        weak_evidence           3.4     normal=0.012;tumor=0.027;\nchr6    16147945        PASS            331.72  normal=0.014;tumor=0.978;\nWhere we see that if there’s the filter weak_evidence the VAF of the tumor is typically low.\nKey observations:\n\nPASS variants typically have:\n\nTumor VAF &gt;0.15 (15%)\nLow/zero VAF in normal (&lt;0.03)\nExample: chr6:325357 has tumor=0.161, normal=0.001\n\nweak_evidence variants show:\n\nVery low tumor VAF (&lt;0.05)\nNear the detection limit\nExample: chr6:106265 has tumor=0.01, normal=0.00671\n\ngermline tagged variants:\n\nSimilar VAF in both tumor and normal\nExample: chr6:5103987 has normal=0.825, tumor=0.834 (very similar)\nThese are inherited variants, not somatic\n\npanel_of_normals filtered variants:\n\nMay have high VAF but appear in technical artifact database\nExample: chr6:9900366 has very high tumor VAF (0.992) but filtered"
  },
  {
    "objectID": "variant_calling.html#copy-number-variation-calling",
    "href": "variant_calling.html#copy-number-variation-calling",
    "title": "Variant calling",
    "section": "Copy number variation calling",
    "text": "Copy number variation calling\nVariation of copy number in genes can have a large effect on the phenotype of a tumor. Therefore, we will also estimate the copy number variation occurring on chromosome 6 and 17. For that, we use CNVkit.\n\n\n\n\n\n\nImportantExercise 4\n\n\n\nCheck out the documentation of CNVkit.py bash, and the helper (cnvkit.py batch -h), create a script called 05_run_cnvkit.sh, and replace the missing values at FIXME.\nAfter that, checkout the visualizations (tumor-scatter.png and tumor-scatter.png) at ~/project/course_data/variants/cnvkit. Do you see any evidence for copy number variation?\n#!/usr/bin/env bash\n\nALIGNDIR=~/project/course_data/alignments\nREFDIR=~/project/course_data/reference\nRESOURCEDIR=~/project/course_data/resources\nVARIANTDIR=~/project/course_data/variants\n\ncnvkit.py batch FIXME \\\n--normal FIXME \\\n--targets FIXME \\\n--fasta FIXME \\\n--annotate \"$RESOURCEDIR\"/refFlat.txt \\\n--output-reference \"$VARIANTDIR\"/reference.cnn \\\n--output-dir \"$VARIANTDIR\"/cnvkit/ \\\n--processes 4 \\\n--scatter \\\n--diagram\n\n\n\n\n\n\n\n\nTipAnswer\n\n\n\n\n\nWe provide the tumor bam, normal bam, the interval list (can also be a bed file) and our reference genome:\n#!/usr/bin/env bash\n\nALIGNDIR=~/project/course_data/alignments\nREFDIR=~/project/course_data/reference\nRESOURCEDIR=~/project/course_data/resources\nVARIANTDIR=~/project/course_data/variants\n\ncnvkit.py batch \"$ALIGNDIR\"/tumor.recal.bam \\\n--normal \"$ALIGNDIR\"/normal.recal.bam \\\n--targets \"$REFDIR\"/exome_regions.bed.interval_list \\\n--fasta \"$REFDIR\"/ref_genome.fa \\\n--annotate \"$RESOURCEDIR\"/refFlat.txt \\\n--output-reference \"$VARIANTDIR\"/reference.cnn \\\n--output-dir \"$VARIANTDIR\"/cnvkit/ \\\n--processes 4 \\\n--scatter \\\n--diagram\nAfter running cnvkit, multiple files are created in ~/project/course_data/variants/cnvkit. The scatter plot is typically interesting to investigate at first:\n\nInterpretation:\nCNVkit reports log2 ratios relative to a diploid (2 copy) baseline:\n\nFormula: Copy number = 2^(log2_ratio) × 2\nExamples:\n\nlog2 ratio = 0 → 2^(0) × 2 = 2 copies (normal diploid)\nlog2 ratio = +0.58 → 2^(0.58) × 2 ≈ 3 copies (gain)\nlog2 ratio = -1.0 → 2^(-1.0) × 2 = 1 copy (loss)\n\n\nHere we see evidence for both losses and gains on both chromosomes:\nChromosome 6:\n\nMultiple segments with varying copy number\nRegions around log2 ratio +0.6 (gain - approximately 3 copies)\nRegions around log2 ratio -0.5 (loss - approximately 1 copy)\nSome neutral regions around 0 (diploid)\n\nChromosome 17:\n\nLarge deletion in the p-arm (short arm, left side): log2 ratio ≈ -0.6 to -0.7\n\nThis represents loss of one copy across a large chromosomal region\n\nGain in the q-arm (long arm, right side): log2 ratio ≈ +0.6\n\nThis represents an extra copy (3 copies total)\n\n\nKey observations:\n\nLog2 ratio of +0.6 ≈ 3 copies (one extra copy: log2(3/2) = 0.58)\nLog2 ratio of -0.6 to -0.7 ≈ 1.2-1.3 copies (partial loss of one allele)\nLog2 ratio of -1.0 = 1 copy (complete loss of one allele: log2(1/2) = -1.0)\nLog2 ratio of +1.0 ≈ 4 copies (duplication: log2(4/2) = 1.0)\n\nThe orange lines represent segmented regions with similar copy number (segments), while the gray dots show individual bin-level measurements from targeted regions.\nNote: These HCC1395 cells are from a TNBC cell line, so we’d expect to see typical TNBC alterations including TP53 loss.\n\n\n\n\n\n\nNoteClinical significance: Chromosome 17 alterations in breast cancer\n\n\n\nThe pattern observed on chromosome 17 is particularly interesting for breast cancer:\n\nChr17p deletion (the large loss we see) often involves TP53 (17p13.1), a critical tumor suppressor\n\nTP53 loss is extremely common in TNBC (&gt;80% of cases)\nLoss of p53 function removes a key cell cycle checkpoint\n\nChr17q gain (the amplification we see) may include genes like ERBB2/HER2 (17q12)\n\nAlthough TNBC is typically HER2-negative by definition, focal amplifications can occur\nOther oncogenes on 17q may also be amplified\n\n\nThis type of arm-level copy number change (one arm deleted, other amplified) is characteristic of chromosomal instability common in cancer.\n\n\n\n\n\n\n\n\n\n\n\nNoteFurther reading\n\n\n\nCNVkit is described in detail in:\n\nTalevich et al. (2016). CNVkit: Genome-Wide Copy Number Detection and Visualization from Targeted DNA Sequencing. PLOS Computational Biology."
  },
  {
    "objectID": "variant_calling.html#summary",
    "href": "variant_calling.html#summary",
    "title": "Variant calling",
    "section": "Summary",
    "text": "Summary\nIn this section, you’ve:\n\n✅ Called somatic variants with Mutect2 using tumor-normal pairs\n✅ Filtered variants based on multiple quality metrics\n✅ Explored VCF format and variant characteristics\n✅ Identified copy number variations with CNVkit\n\nYou now have:\n\nsomatic.filtered.PASS.vcf.gz: High-confidence somatic SNVs\nCNVkit outputs: Copy number segmentation and visualizations\n\nNext steps: We’ll annotate these variants to understand their functional impact and clinical significance."
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#somatic-vs-germline",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#somatic-vs-germline",
    "title": "Variant Effect Predictor (VEP)",
    "section": "Somatic vs Germline",
    "text": "Somatic vs Germline\n\nA germline mutation is inherited by the individual from birth. They can be oncogenic (ie Rb = retinoblastoma)\nA somatic mutation, or acquired mutation, happens in somatic cells instead of germ cells and will not pass to offspring (ie TP53).\n\n\n\n\n\n\n\nFigure 1: Germline vs somatic"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#how-do-mutations-appear",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#how-do-mutations-appear",
    "title": "Variant Effect Predictor (VEP)",
    "section": "How do mutations appear?",
    "text": "How do mutations appear?\n\nMutations occur due to replication errors (1 nucleotide per ~10^4) but with reparation mechanisms (1 error per 10^7 - 10^9)\nAs a consequence of DNA damage (~70,000 nucleotide lesions or modifications per day)\nExposure to mutagens such as UV, smoking increases the mutations’ frequency\n\n\n\n\nExample UV damage,knowgenetics.org\n\n\n\nKey points: - https://www.nature.com/articles/s41576-021-00376-2"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#can-the-cell-repair-them",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#can-the-cell-repair-them",
    "title": "Variant Effect Predictor (VEP)",
    "section": "Can the cell repair them?",
    "text": "Can the cell repair them?\nYes, there are many mechanisms of DNA repair. Some of the most common are:\n\nNER (Nucleotide Excision Repair): Repairs bulky lesions such as thymine dimers caused by UV radiation. This mechanism involves the removal of a short single-stranded DNA segment containing the damage, followed by DNA synthesis using the complementary strand as a template.\nMMR (Mismatch Repair): Fixes replication errors such as base mismatches or insertion/deletion loops. MMR recognizes the newly synthesized strand and corrects errors by removing the incorrect nucleotides and replacing them.\nBER (Base Excision Repair): Repairs single-base lesions such as oxidative damage, alkylation, or deamination. This involves the removal of damaged bases by specific glycosylases, followed by the excision of the resulting abasic site.\nHR (Homologous Recombination): Repairs double-strand breaks using a homologous sequence as a template, typically from a sister chromatid. This is an error-free repair mechanism.\nNHEJ (Non-Homologous End Joining): Repairs double-strand breaks without the need for a homologous template. While quicker, this method is error-prone and can lead to insertions or deletions.\n\nVisualizing DNA Repair Mechanisms\n\n\n\n\n\n\n\nFigure 2: DNA Repair Mechanisms, The origin of human mutation in light of genomic data, Seplyarskiy et al, 2021\n\n\n\n\nKey points: - https://www.nature.com/articles/nrclinonc.2012.3/figures/1"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#acquisition-of-mutation-in-cancer",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#acquisition-of-mutation-in-cancer",
    "title": "Variant Effect Predictor (VEP)",
    "section": "Acquisition of mutation in cancer",
    "text": "Acquisition of mutation in cancer\n\n\nFigure 3: Cancer somatic mutations, The cancer genome, Stratton et al, 2009\n\nKey points: - https://www.nature.com/articles/nature07943"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#concept-of-driver-mutation",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#concept-of-driver-mutation",
    "title": "Variant Effect Predictor (VEP)",
    "section": "Concept of driver mutation",
    "text": "Concept of driver mutation\nSome mutations are more important than others for tumor progression. Perhaps they are more disruptive and detrimental for the cell to harbor. Those can be observed in multiple cancer types (think of TP53 or BRCA1/2).\n\nNot all the driver mutations are known and not all the driver mutations are really always drivers."
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#what-defines-a-driver-mutation",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#what-defines-a-driver-mutation",
    "title": "Variant Effect Predictor (VEP)",
    "section": "What Defines a Driver Mutation?",
    "text": "What Defines a Driver Mutation?\n\nNot all mutations are driving the tumorigenesis!\n\n\nFunctional Impact:\n\nDriver mutations confer a selective growth advantage to cells, promoting tumor development and progression. These mutations often affect genes regulating cell cycle, apoptosis, DNA repair, and immune evasion.\nExample pathways: MAPK, PI3K/AKT, and WNT signaling.\n\nRecurrent Patterns Across Tumors:\n\nFrequently observed across different cancer types (e.g., TP53 in over 50% of cancers).\nSome drivers are specific to tissue types (e.g., EGFR in lung cancer, KIT in gastrointestinal stromal tumors, IDH1 in gliomas)."
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#types-of-driver-mutations",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#types-of-driver-mutations",
    "title": "Variant Effect Predictor (VEP)",
    "section": "Types of Driver Mutations",
    "text": "Types of Driver Mutations\n\nOncogenes:\n\nGain-of-function mutations in genes like KRAS, BRAF, and EGFR drive tumor growth by promoting uncontrolled cell division or survival.\n\nTumor Suppressors:\n\nLoss-of-function mutations in genes like TP53, RB1, and PTEN impair cellular mechanisms that prevent tumor formation.\n\nMutator Genes:\n\nMutations in genes like MLH1 or MSH2 lead to genomic instability, enabling the accumulation of additional mutations."
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#vep-variant-effect-predictor",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#vep-variant-effect-predictor",
    "title": "Variant Effect Predictor (VEP)",
    "section": "VEP (Variant Effect Predictor)",
    "text": "VEP (Variant Effect Predictor)\n\n\n(a) Ensembl-VEP"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#what-is-vep",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#what-is-vep",
    "title": "Variant Effect Predictor (VEP)",
    "section": "What is VEP?",
    "text": "What is VEP?\n\n2010: The first version of VEP was introduced as part of the Ensembl project.\n2012-2015 Functional prediction scores were introduced.\n2017 Other databases are now part of the VEP, such as COSMIC, ClinVar, gnomAD. The tool was made more generalizable and personalizable with the addition of VEP’s plugin feature.\nVEP is 100% written in perl VEP Github\n\n\nKey points: - VEP is widely used in research and clinical settings - Provides comprehensive variant annotation - Especially useful for large-scale analysis"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#important-annotation-databases",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#important-annotation-databases",
    "title": "Variant Effect Predictor (VEP)",
    "section": "Important Annotation Databases",
    "text": "Important Annotation Databases\n\n\nCancer-Specific Resources\nCOSMIC (Catalogue of Somatic Mutations in Cancer)\n\n\n\n\n\n\n\nField\nContent\n\n\n\n\nPurpose\nSomatic mutations in cancer\n\n\nExample\nCOSV59384583; OCCURENCE=1(skin)\n\n\nInterpretation\nMutation seen in skin cancer; frequency indicates driver likelihood\n\n\n\nClinVar (Clinical Variant Database)\n\n\n\nField\nContent\n\n\n\n\nPurpose\nClinical significance assessment\n\n\nExample\nPathogenic/Likely_pathogenic\n\n\nInterpretation\nStrong evidence for disease causation\n\n\n\n\nPopulation & Prediction Resources\ngnomAD (Genome Aggregation Database)\n\n\n\nField\nContent\n\n\n\n\nPurpose\nPopulation allele frequency\n\n\nExample\nAF=0.00001\n\n\nInterpretation\nVery rare (&lt;0.01% frequency)\n\n\n\nAlphaMissense\n\n\n\nField\nContent\n\n\n\n\nPurpose\nAI-predicted functional impact\n\n\nExample\nlikely_pathogenic\n\n\nInterpretation\nModel predicts damaging effect\n\n\n\n\n\n\n\n\n\n\nFiltering Strategy\n\n\nCombine databases for variant prioritization:\n\ngnomAD AF &lt; 0.01 → Filters common variants\nCOSMIC presence → Supports somatic driver role\nClinVar pathogenic → Clinical validation\nAlphaMissense → Functional prediction for novel variants"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#what-does-vep-do",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#what-does-vep-do",
    "title": "Variant Effect Predictor (VEP)",
    "section": "What Does VEP Do?",
    "text": "What Does VEP Do?\nThe Challenge: Imagine annotating thousands of variants manually - searching databases, reviewing literature, interpreting functional impact. This would take weeks and be highly error-prone.\nVEP automates annotation to accelerate discovery:\n\nAnnotates genomic variants (somatic and germline)\nPredicts functional consequences\nIntegrates multiple databases (COSMIC, ClinVar, gnomAD, etc.)\nEssential for cancer genomics and clinical applications\n\n\n\n\n\n\n\nWhat VEP Does NOT Do\n\n\nVEP is powerful, but it’s not magic:\n\nDoes NOT call variants - requires pre-called VCF input\nDoes NOT guarantee accuracy - annotation quality depends on input quality\nDoes NOT replace human judgment - false positives/negatives require expert review\n\nRemember: Automation simplifies the process, but critical thinking and validation remain essential!\n\n\n\n\n\nVEP accelerates but doesn’t replace analysis\nBrainstorming and iteration still required\nQuality in = quality out"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#what-is-not-well-understood",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#what-is-not-well-understood",
    "title": "Variant Effect Predictor (VEP)",
    "section": "What is not well understood?",
    "text": "What is not well understood?\nThere are no databases investigating those aspects of biology that might play an important role in the cancer development. After all it is estimated that &gt;97% of all the mutations are “passenger events” and they do not have direct impact on the tumor growth.\n\nThe effects of epigenetic changes\nGlycosilations\nTransposomes (like LINE-1)\nSV (inversion for example)\nAlternative splicing impacts\nNon-coding RNAs and their alterations\nTumor Microenvironment\nMicrobiome\nEtc."
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#in-summary-why-do-we-use-vep",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#in-summary-why-do-we-use-vep",
    "title": "Variant Effect Predictor (VEP)",
    "section": "In summary: Why do we use VEP?",
    "text": "In summary: Why do we use VEP?\nWe can answer questions like:\n\nHow damaging is a certain somatic mutation?\nWhat is the impact in a particular cancer type?\nIs the mutation known for that cancer?\nAre there therapeutic implications?"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#vep-transcript-selection-priority",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#vep-transcript-selection-priority",
    "title": "Variant Effect Predictor (VEP)",
    "section": "VEP: Transcript Selection & Priority",
    "text": "VEP: Transcript Selection & Priority\nThe Challenge: A single variant can have 4-12+ annotations due to multiple transcript isoforms. Which one matters?\n\n\n1. Handling Transcripts\nVEP options to simplify output when a gene has multiple transcripts:\n\n--pick: One consequence per variant (Best for simple filtering)\n--pick_allele: One per variant allele\n--per_gene: One per gene\n--flag_pick: Flags the “chosen” one but keeps others\n--pick_allele_gene: Most comprehensive filtering\n\nSelection hierarchy:\n\nCanonical transcript (MANE Select for human)\nProtein coding biotype\nMost severe consequence\nLongest transcript\n\n\n2. Consequence Severity\nTop 10 Most Severe:\n\nTranscript ablation\nSplice acceptor/donor variant\nStop gained (Nonsense)\nFrameshift variant\nStop lost\nStart lost\nTranscript amplification\nInframe insertion/deletion\nMissense variant\nProtein altering variant\n\nCancer examples:\n\nHIGH impact: TP53 frameshift → TSG loss\nMODERATE impact: KRAS p.G12D → oncogene gain\n\n\n\n\n\n\n\n\nPractical Tip\n\n\nFor clinical reporting, use --pick with --transcript_version to ensure reproducibility. Always document which transcript was used."
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#vep-impact-categories",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#vep-impact-categories",
    "title": "Variant Effect Predictor (VEP)",
    "section": "VEP Impact Categories",
    "text": "VEP Impact Categories\n\n\n\nVEP’s consequences\n\n\n\n\n\n\n\n\n\n\nImpact\nDescription\nExamples\n\n\n\n\nHIGH\nDisruptive. Likely loss of function.\nFrameshift, Stop Gained, Splice acceptor/donor.\n\n\nMODERATE\nNon-disruptive change to protein.\nMissense, In-frame indel.\n\n\nLOW\nUnlikely to change function.\nSynonymous, Splice region (non-canonical).\n\n\nMODIFIER\nNon-coding / Regulatory.\nIntronic, UTRs, Intergenic.\n\n\n\n\n\n\n\n\n\nImportant Exceptions\n\n\nNot all HIGH impact = pathogenic\nNot all MODERATE impact = benign (e.g., IDH1 p.R132H is LOW but a critical driver mutation)\nAlways consider biological context!"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#polyphen-2-score",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#polyphen-2-score",
    "title": "Variant Effect Predictor (VEP)",
    "section": "PolyPhen-2 Score",
    "text": "PolyPhen-2 Score\nPurpose: Predicts if a missense mutation is damaging based on protein structure and evolutionary conservation.\n\n\nScoring Categories:\n\nProbably Damaging (&gt; 0.85)\n\nHigh confidence functional effect.\n\nPossibly Damaging (0.15 - 0.85)\n\nModerate confidence effect.\n\nBenign (&lt; 0.15)\n\nLikely no phenotypic effect.\n\n\n\n\n\n\n\n\n\nUsage\n\n\nPolyPhen-2 is specific to human proteins.\nIt should be used in conjunction with other tools (like SIFT) to build a consensus on missense variant interpretation."
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#sift-score",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#sift-score",
    "title": "Variant Effect Predictor (VEP)",
    "section": "SIFT Score",
    "text": "SIFT Score\nPurpose: Predicts if an amino acid substitution is deleterious based on sequence conservation across species.\n\n\nScoring Categories:\n\nDeleterious (≤ 0.05)\n\nSubstitution at highly conserved position\nHigh confidence damaging effect\n\nTolerated (&gt; 0.05)\n\nSubstitution at variable position\nLikely benign or neutral effect\n\n\nNote: Lower scores = More damaging (opposite to PolyPhen-2!)\n\n\n\n\n\n\n\nUsage\n\n\nSIFT is available for 10 species in Ensembl (including human, mouse, zebrafish).\nAll possible amino acid substitutions are pre-calculated, making annotation very fast.\nUse in combination with PolyPhen-2 for consensus prediction.\n\n\n\n\n\n\n\n\n\n\nInterpretation Guide\n\n\n\n\n\nSIFT\nPolyPhen-2\nConfidence\n\n\n\n\nDeleterious\nProbably Damaging\nHigh - prioritize\n\n\nTolerated\nBenign\nHigh - likely benign\n\n\nDeleterious\nBenign\nMixed - manual review\n\n\nTolerated\nDamaging\nMixed - manual review"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#revel",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#revel",
    "title": "Variant Effect Predictor (VEP)",
    "section": "REVEL",
    "text": "REVEL\n--plugin REVEL,/path/to/revel/revel_all_chromosomes.tsv.gz\n\nREVEL paper: An Ensemble Method for Predicting the Pathogenicity of Rare Missense Variants\n\nYou can download here the data (~6.5GB): https://sites.google.com/site/revelgenomics/downloads or https://zenodo.org/records/7072866\nunzip revel-v1.3_all_chromosomes.zip\ncat revel_with_transcript_ids | tr \",\" \"\\t\" &gt; tabbed_revel.tsv\nsed '1s/.*/#&/' tabbed_revel.tsv &gt; new_tabbed_revel.tsv\nbgzip new_tabbed_revel.tsv\nPrepare for GRCh38\nzcat new_tabbed_revel.tsv.gz | head -n1 &gt; h\nzgrep -h -v ^#chr new_tabbed_revel.tsv.gz | awk '$3 != \".\" ' | sort -k1,1 -k3,3n - | cat h - | bgzip -c &gt; new_tabbed_revel_grch38.tsv.gz\ntabix -f -s 1 -b 3 -e 3 new_tabbed_revel_grch38.tsv.gz\nUsage:\n--plugin REVEL,file=/path/to/revel/data.tsv.gz"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#alphamissense",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#alphamissense",
    "title": "Variant Effect Predictor (VEP)",
    "section": "AlphaMissense",
    "text": "AlphaMissense\n\nAlphaMissense’s Paper: Accurate proteome-wide missense variant effect prediction with AlphaMissense\n\nDownload link\nPrepare for GRCh38\nwget https://storage.googleapis.com/dm_alphamissense/AlphaMissense_hg38.tsv.gz\ntabix -s 1 -b 2 -e 2 -f -S 1 AlphaMissense_hg38.tsv.gz\nRun it with VEP\n--plugin AlphaMissense,file=/full/path/to/file.tsv.gz"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#dbnsfp",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#dbnsfp",
    "title": "Variant Effect Predictor (VEP)",
    "section": "dbNSFP",
    "text": "dbNSFP\n\ndbNSFP v4 paper: a comprehensive database of transcript-specific functional predictions and annotations for human nonsynonymous and splice-site SNVs\n\nA VEP plugin that retrieves data for missense variants from a tabix-indexed dbNSFP file.\n--plugin dbNSFP,/path/to/dbNSFP.gz,SIFT_score,HDIV_score\nPrepare the data\nversion=4.7c\nwget ftp://dbnsfp:dbnsfp@dbnsfp.softgenetics.com/dbNSFP${version}.zip\nunzip dbNSFP${version}.zip\nzcat dbNSFP${version}_variant.chr1.gz | head -n1 &gt; h\nPrepare for GRCh38\nzgrep -h -v ^#chr dbNSFP${version}_variant.chr* | sort -k1,1 -k2,2n - | cat h - | bgzip -c &gt; dbNSFP${version}_grch38.gz\n  tabix -s 1 -b 2 -e 2 dbNSFP${version}_grch38.gz\nRun it with VEP\n--plugin dbNSFP,/path/to/dbNSFP.gz,LRT_score,GERP++_RS"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#filter-variants-with-vep",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#filter-variants-with-vep",
    "title": "Variant Effect Predictor (VEP)",
    "section": "Filter Variants with VEP",
    "text": "Filter Variants with VEP\nYou can use the tool that is included in the VEP’s suite of tools. This tool generally works very well with data that have been VEP-annotated\nFilter SIFT deleterious events\nfilter_vep -i variant_effect_output.txt -filter \"SIFT is deleterious\" | grep -v \"##\" | head -n5\n Can be used with pipes, for example (might save memory)\nvep -i examples/homo_sapiens_GRCh38.vcf --cache --force_overwrite --sift b --canonical --symbol --tab --fields Uploaded_variation,SYMBOL,CANONICAL,SIFT -o STDOUT | \\\nfilter_vep --filter \"CANONICAL is YES and SIFT is deleterious\"\nOperators:\n\nis: Exact match\nmatch: Regex pattern\n&lt;, &gt;, &lt;=, &gt;=: Numeric comparison\nin: List membership\nand, or: Combine conditions\n\nExample 1: High-confidence damaging\nfilter_vep -i vep_output.txt \\\n  -filter \"SIFT is deleterious and \\\n           PolyPhen is probably_damaging\""
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#notes",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#notes",
    "title": "Variant Effect Predictor (VEP)",
    "section": "Notes",
    "text": "Notes\n\nThere are many other plugins that can be used depending on the context and the specific biological question at hand. You can have a look here: Plugins for VEP\nYou can run multiple plugins at the same time\nThe more plugins the more computationally expensive it could become\nThere is a nice help included in VEP that can be useful for consultation"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#quality-control",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#quality-control",
    "title": "Variant Effect Predictor (VEP)",
    "section": "Quality Control",
    "text": "Quality Control\n\nFilter low-quality variants before annotation\nUse matched normal samples when available\nConsider sequencing artifacts\nDocument filtering criteria\nUse IGV for confirmation"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#annotation-strategy",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#annotation-strategy",
    "title": "Variant Effect Predictor (VEP)",
    "section": "Annotation Strategy",
    "text": "Annotation Strategy\n\nUse multiple prediction algorithms\nConsider tissue-specific expression\nInclude population frequencies\nAdd clinical annotations\nFollow standardized guidelines"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#points-to-keep-in-mind",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#points-to-keep-in-mind",
    "title": "Variant Effect Predictor (VEP)",
    "section": "Points to keep in mind",
    "text": "Points to keep in mind\nInclude MODERATE impact variants\n\nHIGH impact often affects tumor suppressors (TP53, PTEN, RB1)\nMODERATE impact often affects oncogenes (KRAS, BRAF, PIK3CA)\nExamples: KRAS p.G12D, BRAF p.V600E are MODERATE but critical drivers\n\nMany drivers remain unknown\n\nOnly ~500-600 cancer genes well-characterized\nAbsence from databases ≠ passenger mutation\nLook for recurrent mutations across samples\n\nCNV calling limitations\n\nParticularly challenging in WES (only 2% of genome covered)\nRequires adequate tumor purity (&gt;40% ideal) and coverage\nVEP is not specialized for CNV annotation (CNVannotator, ClassifyCNV)\n\n\n\n\n\n\n\nNo Tool is Perfect\n\n\nAlways validate important findings visually (IGV) and consider orthogonal methods for clinical decisions."
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#useful-links",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#useful-links",
    "title": "Variant Effect Predictor (VEP)",
    "section": "Useful Links",
    "text": "Useful Links\n\nVEP Documentation\ngnomAD Browser\nCOSMIC Database\nClinVar\nOncoKB"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#contact-information",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#contact-information",
    "title": "Variant Effect Predictor (VEP)",
    "section": "Contact Information",
    "text": "Contact Information\n\nVEP Support: https://www.ensembl.org/Help/Contact\nDocumentation: http://www.ensembl.org/info/docs/tools/vep/\nGitHub: https://github.com/Ensembl/ensembl-vep\nBioconductor: https://bioconductor.org/"
  },
  {
    "objectID": "slides/03_VEP_variantAnnotationPresentation.html#exercises",
    "href": "slides/03_VEP_variantAnnotationPresentation.html#exercises",
    "title": "Variant Effect Predictor (VEP)",
    "section": "Exercises",
    "text": "Exercises\n\n\n\nGiphy"
  },
  {
    "objectID": "slides/01_course_intro.html#course-etiquette",
    "href": "slides/01_course_intro.html#course-etiquette",
    "title": "Cancer variant analysis",
    "section": "Course etiquette",
    "text": "Course etiquette\n\n\n\n\nEtiquette\n\n\n\n\nVideo on when possible\nUse your first and last name as your Zoom ID\n\nRight-click on yourself &gt; Rename..\n\nMute when not speaking"
  },
  {
    "objectID": "slides/01_course_intro.html#code-of-conduct",
    "href": "slides/01_course_intro.html#code-of-conduct",
    "title": "Cancer variant analysis",
    "section": "Code of conduct",
    "text": "Code of conduct\n\n\nLearning can only be done in a safe environment\nWe abide to the ELIXIR code of conduct during the course\nIf you witness unacceptable behaviour that can’t be dealt with with the people involved in this course, contact the COC oversight group\nMore info: here\n\n\n\n\n\nELIXIR Code of Conduct Principles"
  },
  {
    "objectID": "slides/01_course_intro.html#trainersorganizershelpers",
    "href": "slides/01_course_intro.html#trainersorganizershelpers",
    "title": "Cancer variant analysis",
    "section": "Trainers/organizers/Helpers",
    "text": "Trainers/organizers/Helpers\n\nGregoire Rossier: Training coordinator at SIB\nDiana Marek: Training coordinator at SIB\nGeert Van Geest: Training Project Manager at SIB\nFlavio Lombardo: Computational Biologist at the University Hospital Basel\nDeepak Tanwar: Bioinformaticis Specialist and Trainer at SIB\nAparna Pandey: Bioinformatic Analyst at Interfaculty Bioinformatics Unit, University of Bern"
  },
  {
    "objectID": "slides/01_course_intro.html#learning-outcomes",
    "href": "slides/01_course_intro.html#learning-outcomes",
    "title": "Cancer variant analysis",
    "section": "Learning outcomes",
    "text": "Learning outcomes\n\nUnderstand the difference between germline and somatic variants and the implication of computational analysis\nPerform a somatic variant analysis on a paired sample (tumor – normal) with GATK4\nPerform a somatic variant annotation with VEP and use the results to filter possible high-impact mutations in the cancer genome\n\n\nWe will work with WES data from a tumor of triple negative breast cancer (TNBC) cell line and matched control"
  },
  {
    "objectID": "slides/01_course_intro.html#learning-experiences",
    "href": "slides/01_course_intro.html#learning-experiences",
    "title": "Cancer variant analysis",
    "section": "Learning experiences",
    "text": "Learning experiences\n\n\nLectures\nPolls + quiz questions\nExercises"
  },
  {
    "objectID": "slides/01_course_intro.html#communication",
    "href": "slides/01_course_intro.html#communication",
    "title": "Cancer variant analysis",
    "section": "Communication",
    "text": "Communication\n\nCourse website: https://sib-swiss.github.io/cancer-variants-training/\nShared document\nZulip"
  },
  {
    "objectID": "slides/01_course_intro.html#asking-questions",
    "href": "slides/01_course_intro.html#asking-questions",
    "title": "Cancer variant analysis",
    "section": "Asking questions",
    "text": "Asking questions\n\n\nDuring lectures: zoom functionality – but the chat will be ignored\n\n\n\n\nDuring exercises: #q_and_a channel on Zulip\n\nYou can add a topic for your question, this will open a new conversation-topic."
  },
  {
    "objectID": "slides/01_course_intro.html#tell-us-about-yourself",
    "href": "slides/01_course_intro.html#tell-us-about-yourself",
    "title": "Cancer variant analysis",
    "section": "Tell us about yourself:",
    "text": "Tell us about yourself:\n\nName and affiliation\nResearch area / current project\nExperience with variant analysis\nWhat you hope to learn from this course\n\n…And consider the social channel in Zulip!"
  },
  {
    "objectID": "precourse_preparations.html",
    "href": "precourse_preparations.html",
    "title": "Precourse preparations",
    "section": "",
    "text": "Participants should have knowledge in NGS techniques, quality control and alignment to a reference genome, and detection of genomic variants from read alignment to variant calling and annotation.\nThe competences and knowledge levels required correspond to those taught in courses such as: NGS - Quality Control, Alignment, Visualisation and NGS-Genome Variant Analysis.\nParticipants should have a basic understanding of working with command line tools on Unix-based systems. You can test your skills with Unix with the quiz here. If you do not feel comfortable with UNIX commands, please take our Unix fundamentals e-learning module.\n\n\n\nParticipants should have their own computer with a browser installed (e.g. chrome, firefox, edge), and can access http websites. Test it here: http://httpforever.com/.\n\n\n\nThis course will use Zulip for communication and questions during the course. You will receive an invitation to join our Zulip workspace before the course starts. Zulip is a chat platform that organizes discussions by topics - no prior experience needed, and it works in any web browser. Zulip can be accessed also via desktop/mobile apps."
  },
  {
    "objectID": "precourse_preparations.html#prerequisites",
    "href": "precourse_preparations.html#prerequisites",
    "title": "Precourse preparations",
    "section": "",
    "text": "Participants should have knowledge in NGS techniques, quality control and alignment to a reference genome, and detection of genomic variants from read alignment to variant calling and annotation.\nThe competences and knowledge levels required correspond to those taught in courses such as: NGS - Quality Control, Alignment, Visualisation and NGS-Genome Variant Analysis.\nParticipants should have a basic understanding of working with command line tools on Unix-based systems. You can test your skills with Unix with the quiz here. If you do not feel comfortable with UNIX commands, please take our Unix fundamentals e-learning module.\n\n\n\nParticipants should have their own computer with a browser installed (e.g. chrome, firefox, edge), and can access http websites. Test it here: http://httpforever.com/.\n\n\n\nThis course will use Zulip for communication and questions during the course. You will receive an invitation to join our Zulip workspace before the course starts. Zulip is a chat platform that organizes discussions by topics - no prior experience needed, and it works in any web browser. Zulip can be accessed also via desktop/mobile apps."
  },
  {
    "objectID": "course_schedule.html",
    "href": "course_schedule.html",
    "title": "Course schedule",
    "section": "",
    "text": "Note\n\n\n\nApart from the starting time the time schedule is indicative. Because we can not plan a course by the minute, in practice the time points will deviate."
  },
  {
    "objectID": "course_schedule.html#day-1",
    "href": "course_schedule.html#day-1",
    "title": "Course schedule",
    "section": "Day 1",
    "text": "Day 1\n\n\n\nblock\nstart\nend\nsubject\n\n\n\n\nintroduction\n9:00 AM\n10:00 AM\nIntroduction - lecture\n\n\nblock 1\n10:00 AM\n10:30 AM\nSetup and quality control - exercises\n\n\n\n10:30 AM\n11:00 AM\nBREAK\n\n\nblock 2\n11:00 AM\n12:00 PM\nVariant calling - exercises\n\n\n\n12:00 PM\n1:00 PM\nBREAK\n\n\nblock 3\n1:00 PM\n1:45 PM\nVariant annotation - lecture\n\n\nblock 4\n1:45 PM\n3:00\nVariant annotation - exercises\n\n\n\n3:00 PM\n3:30 PM\nBREAK\n\n\nblock 4\n3:30 PM\n4:10 PM\nVariant annotation - exercises\n\n\nblock 5\n4:10 PM\n5:00 PM\nVisualization - exercises"
  },
  {
    "objectID": "cnv_example_using_vep.html",
    "href": "cnv_example_using_vep.html",
    "title": "CNVs with ENSEMBL VEP",
    "section": "",
    "text": "Annotating CNVkit output\nThe CNVkit is a software that is specifically tailored to call CNV (Copy number Variants) from WES data. It does that by using metrics based on proper targets and off-targets reads in WES data. CNVkit is a python-based tool, that by default outputs *.call.cns and *.cnr. \n\n\n\n\n\n\nNoteWhy annotate CNVs with VEP?\n\n\n\nVEP is primarily designed for SNVs and small indels, not CNVs. For dedicated CNV annotation, specialized tools are more appropriate:\n\nAnnotSV - Specifically designed for structural variant annotation\nSVAnna - Uses ontology-based phenotype matching\nSVAFOTATE - Comprehensive SV annotation\nVarSome - Clinical interpretation platform\n\nSo why are we using VEP for CNVs in this exercise?\n\nPractical reality: Many pipelines already use VEP and it’s convenient to get basic gene-level annotation\nUnderstanding limitations: Learning what VEP can’t do well is as important as what it can\nIntegration: VEP can provide consistent annotation format across SNVs and CNVs for downstream analysis\nPopulation frequencies: VEP can still add gnomAD population frequencies for common CNV regions\n\nSummary: Use VEP for basic CNV gene annotation, but consider specialized tools for clinical interpretation or detailed CNV analysis.\n\n\n\n\n\n\n\n\nImportantIn case you want to transform from .cns to .vcf\n\n\n\n\n\n\nLet’s convert the *.cns (segmentation file) into a VCF file. ~5min\n\n#!/usr/bin/env bash\n\nBASE_DIR=\"${HOME}/project/course_data\"\nRES_DIR=\"${BASE_DIR}/resources\"\nVAR_DIR=\"${BASE_DIR}/variants\"\nCNV_DIR=\"${VAR_DIR}/cnvkit\"\n\n# Convert from call.cns to vcf \ncnvkit.py export vcf \"${CNV_DIR}/tumor.call.cns\" -o \"${CNV_DIR}/tumor.call.vcf\"\n\nWe can gzip the output\n\n# bgzip the file\nbgzip -f \"${CNV_DIR}/tumor.call.vcf\"\n\nNow let’s index the file\n\n# Index\ntabix -p vcf -f \"${CNV_DIR}/tumor.call.vcf.gz\"\n\n\n\nNow we have a nice VCF file and in the right format to call VEP\n\n\n\n\n\n\nImportantCall VEP on CNVkit’s VCF\n\n\n\nObjective: Perform comprehensive annotation of CNVkit’s output VCF file using Ensembl Variant Effect Predictor (VEP).\nTask: Consider that those are not small regions:\n\nAdding ClinVar annotations\nAdding REVEL annotations\nUsing --max_sv_size 100000000 to increase the region size of annotation\nUsing --regulatory as it could be interesting\nAdding population frequencies --af_gnomade (gnomAD data is included in VEP cache)\nAdding plugins (--plugin SpliceRegion, --plugin AlphaMissense, --plugin REVEL)\nFiltering for HIGH/MODERATE impact variants\n\nOption: Consider that VEP will add annotation for each of the transcripts that is overlapping the CNV regions. Therefore the file might be very comprehensive, you can simplify with --per_gene, --pick_allele_gene or --pick. However this can also be excluding interesting data. Moreover for the call you can substitute in the custom clinvar annotation exact with overlap.\nVEP version matters We are using VEP v.115.\nNote on exact vs overlap for ClinVar:\n\nexact: Only annotates if variant coordinates match exactly (strict, fewer results)\noverlap: Annotates if variant overlaps with ClinVar entries (permissive, more results for CNVs)\n\n\n\n\n\n\n\n\n\nTipSolution\n\n\n\n\n\n\n# Base directories\nBASE_DIR=\"${HOME}/project/course_data\"\nRES_DIR=\"${BASE_DIR}/resources\"\nDBS_DIR=\"${BASE_DIR}/VEP_dbs\"\nVAR_DIR=\"${BASE_DIR}/variants\"\nCNV_DIR=\"${VAR_DIR}/cnvkit\"\nVEP_CACHE=\"${HOME}/.vep\"\n\n# Input Files\nMUTECT_VCF=\"${VAR_DIR}/somatic.filtered.PASS.vcf.gz\"\nCLINVAR=\"${DBS_DIR}/clinvar/clinvar.vcf.gz\"\nREVEL=\"${DBS_DIR}/revel/new_tabbed_revel_grch38.tsv.gz\"\nALPHA=\"${DBS_DIR}/alphamissense/AlphaMissense_hg38.tsv.gz\"\n\n# Call VEP with full calls ~5min (overlap)\n# Call VEP with full calls (overlap)\nvep -i \"${CNV_DIR}/tumor.call.vcf.gz\" \\\n  --cache \"${VEP_CACHE}\" \\\n  --assembly GRCh38 \\\n  --format vcf \\\n  --fork 2 \\\n  --max_sv_size 100000000 \\\n  --everything \\\n  --regulatory \\\n  --af_gnomade \\\n  --force_overwrite \\\n  --plugin SpliceRegion \\\n  --plugin REVEL,file=\"${REVEL}\" \\\n  --plugin AlphaMissense,file=\"${ALPHA}\" \\\n  --custom \"${CLINVAR},ClinVar,vcf,overlap,0,CLNSIG,CLNREVSTAT,CLNDN\" \\\n  --output_file \"${CNV_DIR}/tumor.call_annotated_all_overlap.txt\"\n\n# Call VEP per gene (exact)\nvep -i \"$CNV_DIR\"/tumor.call.vcf.gz \\\n  --cache \"${VEP_CACHE}\" \\\n  --assembly GRCh38 \\\n  --format vcf \\\n  --fork 2 \\\n  --max_sv_size 100000000 \\\n  --everything \\\n  --regulatory \\\n  --af_gnomade \\\n  --force_overwrite \\\n  --plugin SpliceRegion \\\n  --plugin REVEL,file=\"${REVEL}\" \\\n  --plugin AlphaMissense,file=\"${ALPHA}\" \\\n  --custom \"${CLINVAR}\",ClinVar,vcf,exact,0,CLNSIG,CLNREVSTAT,CLNDN \\\n  --output_file \"${CNV_DIR}/tumor.call_annotated_all_exact.txt\"\n\n## Exact\n# Filter the data CNV\nfilter_vep \\\n  -i \"${CNV_DIR}/tumor.call_annotated_all_exact.txt\" \\\n  -o \"${CNV_DIR}/tumor.call_annotated_all_IMPACT_filtered_exact.txt\" \\\n  --force_overwrite \\\n  --filter \"(IMPACT is HIGH or IMPACT is MODERATE) or (ClinVar_CLNSIG match pathogenic)\"\n\n## Overlap\n# Filter the data CNV\nfilter_vep \\\n  -i \"${CNV_DIR}/tumor.call_annotated_all_overlap.txt\" \\\n  -o \"${CNV_DIR}/tumor.call_annotated_all_IMPACT_filtered_overlap.txt\" \\\n  --force_overwrite \\\n  --filter \"(IMPACT is HIGH or IMPACT is MODERATE) or (ClinVar_CLNSIG match pathogenic)\"\n\n\n        \nYou can also simplify the output with vep filter\n## OVERALP\n# filtering by Symbol\nfilter_vep \\\n  -i \"${CNV_DIR}/tumor.call_annotated_all_overlap.txt\" \\\n  -o \"${CNV_DIR}/tumor.call_annotated_GENE_filtered_overlap.txt\" \\\n  --filter \"SYMBOL exists\" \\\n  --force_overwrite\n  \n## EXACT\n# filtering by Symbol\nfilter_vep \\\n  -i \"${CNV_DIR}/tumor.call_annotated_all_exact.txt\" \\\n  -o \"${CNV_DIR}/tumor.call_annotated_GENE_filtered_exact.txt\" \\\n  --filter \"SYMBOL exists\" \\\n  --force_overwrite\nWe get for example a duplication of RANBP9 that is annotated having HIGH impact and it is part of the MAME selection (matched between NCBI and Ensembl)\n#Uploaded_variation Location    Allele  Gene    Feature Feature_type    Consequence cDNA_position   CDS_position    Protein_position    Amino_acids Codons  Existing_variation  Extra\nchr6_123855_&lt;DUP&gt;   chr6:123855-28994479    duplication ENSG00000010017 ENST00000011619 Transcript  transcript_amplification    -   -   -   -   -   -   IMPACT=HIGH;STRAND=-1;VARIANT_CLASS=duplication;SYMBOL=RANBP9;SYMBOL_SOURCE=HGNC;HGNC_ID=HGNC:13727;BIOTYPE=protein_coding;CANONICAL=YES;MANE=MANE_Select;MANE_SELECT=NM_005493.3;TSL=1;APPRIS=P1;CCDS=CCDS4529.1;ENSP=ENSP00000011619;SWISSPROT=Q96S59.191;UNIPARC=UPI000006ED83;UNIPROT_ISOFORM=Q96S59-1;OverlapBP=90338;OverlapPC=100.00\nFor CNV annotation we get no data from the plugins and some limited data for clinvar. This is happening because those tools add on SNV and not on CNVs (but in clinvar if you change exact to overalp you will see all the transcripts that are overalapping that region).\n\n\n\nFrom the previous exercise, you might have noticed that annotating CNVs is more challenging than annotating SNVs. This is because:\n\nCNV breakpoints can be imprecise and variable\nThe same CNV event might be reported with slightly different coordinates in different databases\nThe functional impact of CNVs can be complex, affecting multiple genes and regulatory elements\nTools like REVEL and AlphaMissense are specifically designed for SNVs and cannot be applied to CNVs\n\nOne could use more specific data such as the COSMIC, that also contain data on CNVs. Or try DECIPHER (DatabasE of genomiC varIation and Phenotype in Humans using Ensembl Resources) database\n\n\n\n\n\n\nTipAdditional useful options in VEP\n\n\n\n\n\nThere are many other options available in VEP, and the documentation is very comprehensive. Some common options are --filter_common (filters out variants with a minor allele frequency (MAF) ≥ 0.01 (1%)) in any of the populations within these databases) and --total_length (VEP sums up the lengths of all overlapping features, useful for structural variants (SV) annotation). --coding_only can reduce the amount of data to only the coding parts. --check_existing annotates variants with information from existing databases.  In addition there is a web interface to VEP from the ENSEMBL team here"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "SIB course cancer variant analysis",
    "section": "",
    "text": "Trainer - Flavio Lombardo ORCiD\nHelper - Deepak Tanwar ORCID\nHelper - Aparna Pandey ORCID\nContributors - Geert van Geest ORCiD (original course materials)\n\nThis course builds upon materials originally co-developed by Geert van Geest and Flavio Lombardo, with substantial updates and additions by Flavio Lombardo for the 2025 edition."
  },
  {
    "objectID": "index.html#course-team",
    "href": "index.html#course-team",
    "title": "SIB course cancer variant analysis",
    "section": "",
    "text": "Trainer - Flavio Lombardo ORCiD\nHelper - Deepak Tanwar ORCID\nHelper - Aparna Pandey ORCID\nContributors - Geert van Geest ORCiD (original course materials)\n\nThis course builds upon materials originally co-developed by Geert van Geest and Flavio Lombardo, with substantial updates and additions by Flavio Lombardo for the 2025 edition."
  },
  {
    "objectID": "index.html#attribution",
    "href": "index.html#attribution",
    "title": "SIB course cancer variant analysis",
    "section": "Attribution",
    "text": "Attribution\nParts of this course are inspired by the Precision medicine course, from the Griffith lab."
  },
  {
    "objectID": "index.html#license-copyright",
    "href": "index.html#license-copyright",
    "title": "SIB course cancer variant analysis",
    "section": "License & copyright",
    "text": "License & copyright\nLicense: CC BY 4.0\nCopyright: SIB Swiss Institute of Bioinformatics"
  },
  {
    "objectID": "index.html#overview",
    "href": "index.html#overview",
    "title": "SIB course cancer variant analysis",
    "section": "Overview",
    "text": "Overview\nCancer is a disease of the genome. Mutations of genes that regulate cell proliferation and cell death result in uncontrolled growth eventually causing symptoms. During cancer progression, mutations build up that not only affect cell growth, but also can suppress the immune system, increase the chance of metastases and promote genome instability leading to additional malignant mutations.\nCharacterizing the mutations of malignant tissue has been instrumental for the development of the diagnosis, prognosis and treatment of cancer in the last decades. Cancer is a highly heterogeneous disease, and by knowing the type of mutations, we have a better understanding of the nature of tumors, and can apply precision medicine approaches, like targeted drug and immune therapy.\nCancer variants are somatic, which means that they exist in only a part of the cells in the tissue. Even in a sample of a solid tumor, only a part of the cells contains the driver mutations. This makes analysis of cancer variants more challenging than inherited variants, where we assume (almost) all cells have the same genome.\nIn this course, you will learn the concepts of calling somatic variants from next generation sequencing data, and the basics of performing cancer variant annotation. The practical work will be mainly based on the GATK4 (Mutect2) pipeline and Ensembl’s Variant Effect Predictor (VEP)."
  },
  {
    "objectID": "index.html#audience",
    "href": "index.html#audience",
    "title": "SIB course cancer variant analysis",
    "section": "Audience",
    "text": "Audience\nThis intermediate level course is addressed to researchers and clinicians who work with cancer biology and want to get started with performing somatic variant analysis and interpretation of the results."
  },
  {
    "objectID": "index.html#learning-outcomes",
    "href": "index.html#learning-outcomes",
    "title": "SIB course cancer variant analysis",
    "section": "Learning outcomes",
    "text": "Learning outcomes\nAt the end of the course, the participants should be able to:\n\nUnderstand the difference between germline and somatic variants and the implication of computational analysis\nPerform a somatic variant analysis on a paired sample (tumor – normal) with GATK4\nPerform a somatic variant annotation with VEP and use the results to filter possible high-impact mutations in the cancer genome"
  },
  {
    "objectID": "quality_control.html",
    "href": "quality_control.html",
    "title": "Setup & quality control",
    "section": "",
    "text": "Course intro     Introduction to cancer variant analysis"
  },
  {
    "objectID": "quality_control.html#presentations",
    "href": "quality_control.html#presentations",
    "title": "Setup & quality control",
    "section": "",
    "text": "Course intro     Introduction to cancer variant analysis"
  },
  {
    "objectID": "quality_control.html#exercises",
    "href": "quality_control.html#exercises",
    "title": "Setup & quality control",
    "section": "Exercises",
    "text": "Exercises\n\nFirst login\nIf you are participating in this course with a teacher, you have received a link and a password. Copy-paste the link (including the port, e.g.: http://12.345.678.91:10002) in your browser. This should result in the following page:\n\n\n\n\n\n\n\nNote\n\n\n\nThe link gives you access to a web version of Visual Studio Code. This is a powerful code editor that you can also use as a local application on your computer.\n\n\nType in the password that was provided to you by the teacher. Now let’s open the terminal. You can do that by clicking Application menu &gt; Terminal &gt; New Terminal:\n\nFor a.o. efficiency and reproducibility it makes sense to execute your commands from a script. With use of the ‘new file’ button:\n\n\n\nSetup\nWe will start the exercises with pre-aligned bam files. To start, download and extract the course_data folder:\nwget https://cancer-variants-training.s3.eu-central-1.amazonaws.com/course_data.tar.gz\ntar -xvzf course_data.tar.gz\nrm course_data.tar.gz\nNow, check out the directory course_data and see what’s in there (e.g. with tree):\n└── course_data\n    ├── alignments\n    │   ├── normal.recal.bai\n    │   ├── normal.recal.bam\n    │   ├── tumor.recal.bai\n    │   └── tumor.recal.bam\n    ├── reads\n    │   ├── normal_R1.fastq.gz\n    │   ├── normal_R2.fastq.gz\n    │   ├── tumor_R1.fastq.gz\n    │   └── tumor_R2.fastq.gz\n    ├── reference\n    │   ├── exome_regions.bed.interval_list\n    │   ├── ref_genome.dict\n    │   ├── ref_genome.fa\n    │   ├── ref_genome.fa.fai\n    │   └── ref_genome.fa.gz\n    ├── resources\n    │   ├── 1000G_phase1.snps.high_confidence.hg38.subset.vcf.gz\n    │   ├── 1000G_phase1.snps.high_confidence.hg38.subset.vcf.gz.tbi\n    │   ├── 1000G_phase1.snps.high_confidence.hg38.vcf.gz\n    │   ├── 1000G_phase1.snps.high_confidence.hg38.vcf.gz.tbi\n    │   ├── 1000g_pon.hg38.subset.vcf.gz\n    │   ├── 1000g_pon.hg38.subset.vcf.gz.tbi\n    │   ├── 1000g_pon.hg38.vcf.gz\n    │   ├── 1000g_pon.hg38.vcf.gz.tbi\n    │   ├── af-only-gnomad.hg38.subset.vcf.gz\n    │   ├── af-only-gnomad.hg38.subset.vcf.gz.tbi\n    │   ├── af-only-gnomad.hg38.vcf.gz\n    │   ├── af-only-gnomad.hg38.vcf.gz.tbi\n    │   ├── Mills_and_1000G_gold_standard.indels.hg38.subset.vcf.gz\n    │   ├── Mills_and_1000G_gold_standard.indels.hg38.subset.vcf.gz.tbi\n    │   ├── Mills_and_1000G_gold_standard.indels.hg38.vcf.gz\n    │   ├── Mills_and_1000G_gold_standard.indels.hg38.vcf.gz.tbi\n    │   ├── refFlat.txt\n    │   └── refFlat.txt.gz.1\n    └── VEP_dbs\n        ├── alphamissense\n        │   ├── AlphaMissense_hg38.tsv.gz\n        │   └── AlphaMissense_hg38.tsv.gz.tbi\n        ├── clinvar\n        │   ├── clinvar.vcf.gz\n        │   └── clinvar.vcf.gz.tbi\n        └── revel\n            ├── new_tabbed_revel_grch38.tsv.gz\n            ├── new_tabbed_revel_grch38.tsv.gz.tbi\n            └── new_tabbed_revel.tsv.gz\n\n10 directories, 38 files\nShowing us that we have three directories:\n\nalignments: containing bam files of tumor and normal\nreference: containing the genome fasta file and target intervals\nresources: containing amongst other variant files (vcf) from among other the 1000 genomes project and gnomAD\nVEP_dbs: Clinvar and alphamissense and revel databases for usage with VEP.\n\nThe dataset we’re working with is prepared by the developers of the Precision medicine bioinformatics course by the Griffith lab. It is whole exome sequencing (WES) data of cell lines derived from a tumor of triple negative breast cancer (TNBC) (HCC1395) and derived from normal tissue (HCC1395 BL).\nYou are strongly encouraged to your work with scripts during the course, which you store in the directory scripts. Therefore create a scripts directory:\ncd ~/project/\nmkdir scripts \n\n\nQuality control of the bam files\nFirst we use the information in the header to get information about the contents of the bam file and how it was generated. In order to use the tools installed for this course activate the mamba environment (do this every time you open a new terminal):\nmamba activate ngs-tools \n\n\n\n\n\n\nNoteWhy QC matters for cancer variant calling\n\n\n\nIn somatic variant analysis, we’re looking for variants present in tumor but not normal tissue. These are often present at low allele frequencies (especially in heterogeneous tumors or with contamination). Therefore:\n\nCoverage depth matters: Low-frequency variants (5-10% VAF) need &gt;100x coverage for reliable detection\nDuplicate marking is critical: PCR duplicates can create false variants or inflate allele frequencies\nOn-target rates: Poor capture efficiency means lower power to detect somatic mutations in genes of interest\nContamination: Normal cell contamination in tumor samples dilutes somatic variants\n\n\n\n\n\n\n\n\n\nImportantExercise 1\n\n\n\nCheck out the contents of the headers of the bam files with samtools view -H, and answer the following questions:\n\nHow is the bam file sorted?\nWhich chromosomes were used as reference?\nHow many read groups are in there, what is the readgroup ID and what is the sample name?\nWhich aligner was used?\nIf there are duplicates in there, how are they marked?\nWhich other programs were run to create the bam file?\n\n\n\n\n\n\n\n\n\nTipAnswer\n\n\n\n\n\nTo get information on the bam header we run\ncd ~/project/course_data/alignments\nsamtools view -H normal.recal.bam\nWhich returns:\n@HD     VN:1.6  SO:coordinate\n@SQ     SN:chr6 LN:170805979\n@SQ     SN:chr17        LN:83257441\n@RG     ID:HWI-ST466.C1TD1ACXX.normal   LB:normal       PL:ILLUMINA     SM:normal       PU:HWI-ST466.C1TD1ACXX\n@PG     ID:bwa  PN:bwa  VN:0.7.17-r1188 CL:bwa mem /config/data/reference//ref_genome.fa /config/data/reads/normal_R1.fastq.gz /config/data/reads/normal_R2.fastq.gz\n@PG     ID:samtools     PN:samtools     PP:bwa  VN:1.21 CL:samtools sort\n@PG     ID:samtools.1   PN:samtools     PP:samtools     VN:1.21 CL:samtools view -bh\n@PG     ID:MarkDuplicates       VN:Version:4.5.0.0      CL:MarkDuplicates --INPUT /config/data/alignments/normal.rg.bam --OUTPUT /config/data/alignments/normal.rg.md.bam --METRICS_FILE /config/data/alignments/marked_dup_metrics_normal.txt ...   PN:MarkDuplicates\n@PG     ID:GATK ApplyBQSR       VN:4.5.0.0      CL:ApplyBQSR --output /config/project/data/alignments/.recal.bam --bqsr-recal-file /config/project/data/alignments/normal.bqsr.recal.table --input /config/project/data/alignments/normal.rg.md.bam ...        PN:GATK ApplyBQSR\n@PG     ID:samtools.2   PN:samtools     PP:samtools.1   VN:1.21 CL:samtools view -H tumor.recal.bam\n\nFrom the @HD tag, we can see that the bam file is sorted by coordinate.\nWe have two lines starting with @SQ, which gives us information about the reference used. The reference genome used contains chromosomes 6 and 17.\nWe have one line starting with @RG. Specifying there is a read group with ID HWI-ST466.C1TD1ACXX.normal and sample name (SM) normal.\nIn order to know which programs were run to generate this bam file, we can use the @PG tags. Here, we see that the aligner used was bwa mem\nThe duplicates were marked with MarkDuplicates.\nTo sort and compress samtools sort and samtools view were used. For base quality score recalibration (BQSR) GATK ApplyBQSR was used.\n\n\n\n\nNow we extract information from the alignments themselves. We first have a look at few alignments and then get a summary of the alignments with samtools flagstat.\n\n\n\n\n\n\nImportantExercise 2\n\n\n\nCheck out the first few alignments with samtools view and head.\n\nWhat is likely the read length used?\nAre the reads single-end or paired-end?\nAre the first reads tagged with the readgroup ID?\n\n\n\n\n\n\n\n\n\nTipAnswer\n\n\n\n\n\nThe command:\nsamtools view normal.recal.bam | head -3\nReturns the first three alignments:\nHWI-ST466:135068617:C1TD1ACXX:7:1114:9733:82689 163     chr6    60001   60      100M    =       60106   205     GATCTTATATAACTGTGAGATTAATCTCAGATAATGACACAAAATATAGTGAAGTTGGTAAGTTATTTAGTAAAGCTCATGAAAATTGTGCCCTCCATTC     ;B@EDB@A@A@DDDGBGBFCBC?DBEEGCGCAADAGCECDCDDDBABAGBECEGCBHH@?EGBCBCDDBHBAEEHGDFBBHBDDDBCHBGEFFEGEDBBG     MC:Z:100M       MD:Z:100        PG:Z:MarkDuplicates     RG:Z:HWI-ST466.C1TD1ACXX.normal NM:i:0  AS:i:100        XS:i:0\nHWI-ST466:135068617:C1TD1ACXX:7:1303:2021:90688 99      chr6    60001   60      100M    =       60104   203     GATCTTATATAACTGTGAGATTAATCTCAGATAATGACACAAAATATAGTGAAGTTGGTAAGTTATTTAGTAAAGCTCATGAAAATTGTGCCCTCCATTC     &gt;A@FDB@A?@&gt;DDCE@FAF@?BAC&gt;ECFCGBAADBEADBDCDDD@@A@FAFADD?ABF@@EF?@ABCDAFB?DCGEBEB@EBCDCBCHBFEFFDGFCBBG     MC:Z:100M       MD:Z:100        PG:Z:MarkDuplicates     RG:Z:HWI-ST466.C1TD1ACXX.normal NM:i:0  AS:i:100        XS:i:0\nHWI-ST466:135068617:C1TD1ACXX:7:2304:7514:30978 113     chr6    60001   60      2S98M   =       61252   1194    TAGATCTTATATAACTGTGAGATTAATCTCAGATAATGACACAAAATATAGTGAAGTTGGTAAGTTATTTAGTAAAGCTCATGAAAATTGTGCCCTCCAT     &gt;DHABFEACBBBCBGCECHEGBEACBDHCGCHCBDBBFAEAGBCCB@BAEECGBEEDBED&gt;@EDDABDDADE@CBDFFBFBCFCCBADBDBDFFFAFF?@     MC:Z:60S40M     MD:Z:98 PG:Z:MarkDuplicates     RG:Z:HWI-ST466.C1TD1ACXX.normal NM:i:0  AS:i:98 XS:i:0\n\nAt the CIGAR strings we see 100M and 2S98M, meaning that the original read had 100 base pairs. So it’s likely a read length of 100 bp has been used.\nThis question might be a bit more challenging. In the 5th column we see an equal sign (=). This shows that the mate is mapped to same chromosome, so suggesting we are working with paired-end reads. Secondly, at the @PG header tag, we saw that bwa mem took two fastq files (normal_R1.fastq.gz and normal_R2.fastq.gz) as input. Lastly, we can use the sam flags in the second column to figure that out. If you paste the first flag, 163, in the explain sam flags website, we can see that the read is paired.\nYes, the read group tag starts with RG, and is specified for all three alignments.\n\n\n\n\n\n\n\n\n\n\nImportantExercise 3\n\n\n\nCreate a script called 01_samtools_flagstat.sh and store it in ~/project/scripts. Use samtools flagstat to summarize the alignments in both bam files. How many reads are in the bam files? And how many alignments are marked as duplicate?\n\n\n\n\n\n\n\n\nTipAnswer\n\n\n\n\n\ncd ~/project/course_data/alignments\n\nfor sample in tumor normal\ndo\n    samtools flagstat \"$sample\".recal.bam &gt; \"$sample\".recal.bam.flagstat\ndone\nreturns for normal.recal.bam:\n12744793 + 0 in total (QC-passed reads + QC-failed reads)\n12733034 + 0 primary\n0 + 0 secondary\n11759 + 0 supplementary\n1397598 + 0 duplicates\n1397598 + 0 primary duplicates\n12671529 + 0 mapped (99.43% : N/A)\n12659770 + 0 primary mapped (99.42% : N/A)\n12733034 + 0 paired in sequencing\n6366517 + 0 read1\n6366517 + 0 read2\n12515974 + 0 properly paired (98.30% : N/A)\n12586532 + 0 with itself and mate mapped\n73238 + 0 singletons (0.58% : N/A)\n20414 + 0 with mate mapped to a different chr\n13194 + 0 with mate mapped to a different chr (mapQ&gt;=5)\nShowing us that we have 12,744,793 reads, and all those were paired. Of the alignments, 1,397,598 were marked as duplicate. If we do the same for the tumor bam file we see that it has 16,674,562 reads and 1,871,521 alignment marked as duplicate.\n\n\n\nSo, all looks good until now. We have many reads and high alignment rates. The bam files seem to be ready for variant analysis, because they have read groups, duplicates are marked and they are sorted by coordinate. However, since we are working with whole exome sequencing (WES) data, we would like to know whether the reads align to the target regions and what kind of coverage we have. For this, we use gatk CollectHsMetrics.\n\n\n\n\n\n\nImportantExercise 4\n\n\n\nCreate a script called 02_gatk_collecthsmetrics.sh in ~/project/scripts to run gatk CollectHsMetrics on the two bam files. Here’s an example:\nALIGNDIR=~/project/course_data/alignments\nREFDIR=~/project/course_data/reference\nRESOURCEDIR=~/project/course_data/resources\n\nfor sample in tumor normal\ndo\n    gatk CollectHsMetrics \\\n    -I \"$ALIGNDIR\"/\"$sample\".recal.bam \\\n    -O \"$ALIGNDIR\"/\"$sample\".recal.bam_hs_metrics.txt \\\n    -R \"$REFDIR\"/ref_genome.fa \\\n    --BAIT_INTERVALS \"$REFDIR\"/exome_regions.bed.interval_list \\\n    --TARGET_INTERVALS \"$REFDIR\"/exome_regions.bed.interval_list\ndone \nThe produced reports are not so easy to read. To parse the metrics file, we run multiqc on the directory:\ncd ~/project/course_data/alignments\nmultiqc .\nDownload the multiqc report (multiqc_report.html) by right-clicking on the file and select ‘Download’. Check out the hybrid-selection metrics or by clicking here:  multiqc report  . How did the hybrid capture go? Are most bases on-target? What kind of coverages can we expect in the target regions?\n\n\n\n\n\n\n\n\nNote\n\n\n\nYou can find the documentation on the different metrics here. Note that the descriptions of the metrics are not always correct. The metrics with ON_BAIT contain information including duplicates, while ON_TARGET without duplicates. This has been an issue since 2020, and hasn’t been worked on unfortunately.\n\n\n\n\n\n\n\n\nTipAnswer\n\n\n\n\n\nWe see that we have a fold enrichment of around 22 and about 45% usable bases on-target. About 90% were ‘selected bases’, which means bases aligning within 250 bp of the target region. We’re looking at a de-duplicated coverage of 84x for the normal sample and 114.3x for the tumor sample. So, on average, we seem to have acceptable coverages for both samples.\nNotice that tumor coverage (114x) is higher than normal (84x). This is intentional in cancer studies because:\n\nTumor samples may have subclonal populations with low-frequency variants\nTumor purity varies: A deeper coverage is needed to detect variants in impure samples\nGenerally aim for 2-3x higher coverage in tumor than matched normal"
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#learning-objectives",
    "href": "slides/02_introduction_cancer_variants.html#learning-objectives",
    "title": "Cancer Variant Analysis",
    "section": "Learning Objectives",
    "text": "Learning Objectives\nAfter this session, you will be able to:\n\nUnderstand why cancer is fundamentally a genomic disease\nDistinguish between somatic and germline variants\nIdentify different types of mutations in cancer\nUnderstand sequencing approaches for cancer genomics\nComprehend the bioinformatics workflow for variant detection\nAppreciate the clinical relevance of variant calling\n\n\nStart by setting expectations. Cancer genomics is a rapidly evolving field that combines molecular biology with computational analysis."
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#cancer-a-disease-of-the-genome",
    "href": "slides/02_introduction_cancer_variants.html#cancer-a-disease-of-the-genome",
    "title": "Cancer Variant Analysis",
    "section": "Cancer: A Disease of the Genome",
    "text": "Cancer: A Disease of the Genome\n\n\nKey characteristics:\n\nAbnormal cell growth - uncontrolled proliferation\nInvasive potential - ability to spread (metastasis)\nInitiated by acquired genomic mutations affecting cell growth regulators\nMutations occur stochastically, but rate influenced by environment\nClonal evolution - natural selection of malignant cells\n\n\n\n\n\nCT image showing multiple lung masses in a patient with metastatic testicular seminoma, Source\n\n\n\n\n\n\n\n\n\nDriver vs Passenger Mutations\n\n\nCancer genomes typically harbor 2-8 driver mutations (Vogelstein et al., 2013), though this varies by cancer type. Pediatric cancers often have fewer drivers, while hypermutated adult cancers may have more. Drivers represent a small minority of total mutations."
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#hereditary-vs-sporadic-cancer",
    "href": "slides/02_introduction_cancer_variants.html#hereditary-vs-sporadic-cancer",
    "title": "Cancer Variant Analysis",
    "section": "Hereditary vs Sporadic Cancer",
    "text": "Hereditary vs Sporadic Cancer\n\n\nSporadic (~90-95%)\n\nAcquired somatic mutations\nAccumulate during lifetime\nEnvironmental factors contribute\n\nHereditary (~5-10%)\n\nInherited predisposition alleles\nBRCA1/2 (breast, ovarian)\nLynch syndrome genes (colorectal)\nStill require somatic “second hits”\n\n\n\n\n\nKnudson hypothesis: Tumor Suppressor Gene (Knudson, 1971), Source\n\n\n\n\n\nTiming of Mutation Events: An earlier mutation (a) produces a larger population of mutant cells, than a later event (b), (Oota, 2020) Source\n\n\n\n\n\n\n\n\n\nClinical Relevance\n\n\nHereditary cancer syndromes have implications for family screening, risk reduction, and treatment options (e.g., PARP inhibitors for BRCA carriers)."
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#the-hallmarks-of-cancer",
    "href": "slides/02_introduction_cancer_variants.html#the-hallmarks-of-cancer",
    "title": "Cancer Variant Analysis",
    "section": "The Hallmarks of Cancer",
    "text": "The Hallmarks of Cancer\n8 Core Hallmarks:\n\n\n\n\n\n\n\nHallmark\nDescription\n\n\n\n\nSustaining proliferative signaling\nSelf-sufficiency in growth signals\n\n\nEvading growth suppressors\nInsensitivity to anti-growth signals\n\n\nResisting cell death\nEvading apoptosis\n\n\nEnabling replicative immortality\nLimitless replicative potential\n\n\nInducing angiogenesis\nSustained blood vessel formation\n\n\nActivating invasion & metastasis\nTissue invasion and spread\n\n\nAvoiding immune destruction\nEscaping immune surveillance\n\n\nDeregulating cellular energetics\nAltered metabolism (Warburg effect)\n\n\n\n2 Enabling Characteristics: Genome instability & mutation; Tumor-promoting inflammation\n\n\n\n\n\n\nReference\n\n\nHanahan & Weinberg (2011) “Hallmarks of Cancer: The Next Generation” - Cell"
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#variant-terminology-essential-definitions",
    "href": "slides/02_introduction_cancer_variants.html#variant-terminology-essential-definitions",
    "title": "Cancer Variant Analysis",
    "section": "Variant Terminology: Essential Definitions",
    "text": "Variant Terminology: Essential Definitions\n\n\nMutation: The process of change in DNA\nVariant: A difference in DNA sequence compared to a reference (the outcome)\nSomatic variant: Occurs only in specific cells/tissues - Not inherited - Arises during lifetime\nGermline variant: Present in all cells - Can be passed to offspring - Present from conception\nPolymorphism: Traditionally defined as variant &gt;1% frequency in population (though “variant” is now preferred terminology)\n\n\n\n\nPTC (Phenylthiocarbamide): A chemical that tastes bitter only to those with a specific inherited dominant variant. This pedigree shows its germline inheritance pattern. Source"
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#mutation-vs-variant-a-practical-example",
    "href": "slides/02_introduction_cancer_variants.html#mutation-vs-variant-a-practical-example",
    "title": "Cancer Variant Analysis",
    "section": "Mutation vs Variant: A Practical Example",
    "text": "Mutation vs Variant: A Practical Example\n\n\nThe Yellow Flower Example:\n\nMutation: The change in DNA that caused petals to turn yellow\nVariant: The resulting DNA difference between yellow and white flowers\n\nThis is a somatic mutation - occurring during the plant’s development in one branch, analogous to somatic mutations in cancer.\nThe CCD4a gene mutation prevents breakdown of carotenoids, leading to yellow pigmentation.\n\n\n\n\nMutation example: chrysanthemum flowers (credit: Geert van Gest). Source"
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#types-of-mutations-in-cancer",
    "href": "slides/02_introduction_cancer_variants.html#types-of-mutations-in-cancer",
    "title": "Cancer Variant Analysis",
    "section": "Types of Mutations in Cancer",
    "text": "Types of Mutations in Cancer\nSmall-scale mutations\n\nSNVs (Single Nucleotide Variants)\nINDELs (Insertions and Deletions)\n\nStructural variations\n\nLarge INDELs (&gt;50bp)\nTranslocations - chromosomal rearrangements\nInversions - reversed DNA segments\nFusion transcripts - gene fusions from translocations\nCNV (Copy Number Variation) - gains/losses of genomic regions\n\nLOH (Loss of Heterozygosity) is a consequence of CNV or copy-neutral events, not a mutation type itself.\n\n\n\n\n\n\nClinical Relevance\n\n\nDifferent mutation types require different detection methods and have distinct clinical implications for treatment selection."
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#mutational-signatures-fingerprints-of-mutagenesis",
    "href": "slides/02_introduction_cancer_variants.html#mutational-signatures-fingerprints-of-mutagenesis",
    "title": "Cancer Variant Analysis",
    "section": "Mutational Signatures: Fingerprints of Mutagenesis",
    "text": "Mutational Signatures: Fingerprints of Mutagenesis\n\n\nEach mutational process leaves a characteristic pattern:\n\nSignature 1: Aging, C&gt;T at CpG sites, Transition (Py \\(\\leftrightarrow\\) Py)\nSignature 4: Tobacco smoking, C&gt;A, Transversion (Py \\(\\leftrightarrow\\) Pu)\nSignature 6: Mismatch repair (MMR) deficiency\nSignature 7: UV light, C&gt;T at dipyrimidines, Transition\n\nClinical applications:\n\nUnderstanding tumor etiology (e.g. Signature 4, 7)\nTreatment selection (e.g., PARP inhibitors for HRD) (Signature 3)\nImmunotherapy response prediction (Signature 6)\n\n\n\n\n\nMutational signature SBS1: Ageing signature. Source\n\n\n\n\n\nMutational signature SBS4: Smoking signature. Source\n\n\n\n\n\nTransition: Swapping similar shapes (Purine \\(\\leftrightarrow\\) Purine or Pyrimidine \\(\\leftrightarrow\\) Pyrimidine). Transversion: Swapping different shapes (Purine \\(\\leftrightarrow\\) Pyrimidine).\n\n\n\n\n\n\n\n\n\n\nReference\n\n\nAlexandrov et al. (2020) “The repertoire of mutational signatures in human cancer” - Nature"
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#sequencing-strategies-for-cancer-genomics",
    "href": "slides/02_introduction_cancer_variants.html#sequencing-strategies-for-cancer-genomics",
    "title": "Cancer Variant Analysis",
    "section": "Sequencing Strategies for Cancer Genomics",
    "text": "Sequencing Strategies for Cancer Genomics\n\n\nCoverage strategies\n\nWhole Genome Sequencing (WGS)\n\nComplete genome coverage\nDetects all variant types\nBest for structural variants\n\nWhole Exome Sequencing (WES) (Bait Capture)\n\nProtein-coding regions only\nCost-effective (WES 100x: 25 M 2 x 100 bpWGS 30x: 450 M 2 x 100 bp)\nMisses non-coding regions\n\nCustom panels (Bait Capture, mostly)\n\nTargeted cancer genes\nDeep coverage\n\n\n\nSequencing technologies\nShort reads (2x150bp standard):\n\nIllumina, MGI, Element, Ultima\nHigh accuracy, mature pipelines\n\nLong reads:\n\nPacBio HiFi: &gt;Q30 accuracy\nOxford Nanopore: Q20+ with R10.4.1\nSuperior for SVs and phasing\n\n\n\n\nSequencing cost vs throughput, credit: Geert van Gest\n\n\n\n\n\n\n\n\n\nDepth Recommendations\n\n\nWGS: 60-100x tumor, 30-40x normal WES: 100-200x ctDNA: 10,000-30,000x"
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#experimental-design-tumor-normal-pairs",
    "href": "slides/02_introduction_cancer_variants.html#experimental-design-tumor-normal-pairs",
    "title": "Cancer Variant Analysis",
    "section": "Experimental Design: Tumor-Normal Pairs",
    "text": "Experimental Design: Tumor-Normal Pairs\n\n\nThe challenge: Tumor tissue is heterogeneous - contains: - Tumor cells - Immune infiltrates - Stromal cells - Normal tissue\nSolution: Paired samples\n\nTumor sample - from the malignancy\nNormal sample - typically blood\n\nFor hematological malignancies, use skin biopsy or buccal swab (blood IS the tumor!)\n\n\n\n\nIGV normal matched vs tumor\n\n\n\n\n\n\n\n\n\nTumor Purity\n\n\nTypical tumor purity ranges from 30-80%. Samples below 20-30% purity may have insufficient power for reliable somatic variant detection. Consider pathologist review or microdissection."
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#bioinformatics-workflow-overview",
    "href": "slides/02_introduction_cancer_variants.html#bioinformatics-workflow-overview",
    "title": "Cancer Variant Analysis",
    "section": "Bioinformatics Workflow Overview",
    "text": "Bioinformatics Workflow Overview\n\n\n\n\n\nflowchart LR\n    A[Raw FASTQ] --&gt; B[QC + Adapter&lt;br/&gt;fastp/MultiQC]\n    B --&gt; C[Alignment&lt;br/&gt;bwa-mem2]\n    C --&gt; D[Add Read Groups]\n    D --&gt; E[Mark Duplicates&lt;br/&gt;GATK]\n    E --&gt; F[BQSR]\n    F --&gt; G[Contamination&lt;br/&gt;Check]\n    G --&gt; H[Mutect2]\n    H --&gt; I[Filter&lt;br/&gt;Calls]\n    I --&gt; J[Annotation&lt;br/&gt;VEP]\n\n    %% Define the yellow style class\n    classDef covered fill:#ffeb3b,stroke:#333,stroke-width:2px;\n\n    %% Apply the class to specific nodes\n    class B,H,I,J covered;\n\n\n\n\n\n\n\n\n\n\n\n\nCritical Note\n\n\nVariant annotation is essential but often overlooked! Without functional annotation and clinical database lookup, variants have limited utility.\n\n\n\n\n\n\n\n\n\nNote\n\n\nCourse Scope\nThe steps highlighted in yellow are directly discussed in this course.\nThe remaining steps are not mentioned here but are covered in other courses (e.g., NGS - Variant Analysis and NGS - Quality Control, Alignment, Visualisation). However, we provide the scripts for the analysis in the course GitHub repo."
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#the-sambamcram-file-formats",
    "href": "slides/02_introduction_cancer_variants.html#the-sambamcram-file-formats",
    "title": "Cancer Variant Analysis",
    "section": "The SAM/BAM/CRAM File Formats",
    "text": "The SAM/BAM/CRAM File Formats\nPurpose: Store sequence alignments\n\n\nKey points:\n\nSAM: Text-based (Human readable)\nBAM: Lossless binary compressed SAM\n\nIndexable (Fast random access)\n\nCRAM: Ref-based compression\n\nLossless or Lossy modes\n~30-60% smaller than BAM\nRequires access to the reference genome for decoding\n\n\n\n1. Header (@ lines)\n@HD VN:1.6  SO:coordinate\n@SQ SN:chr6 LN:170805979\n@SQ SN:chr17    LN:83257441\n@RG ID:HWI-ST466.C1TD1ACXX.normal   LB:normal   PL:ILLUMINA SM:normal   PU:HWI-ST466.C1TD1ACXX\n@PG ID:bwa  PN:bwa  VN:0.7.17-r1188 CL:bwa mem /config/data/reference//ref_genome.fa /config/data/reads/normal_R1.fastq.gz /config/data/reads/normal_R2.fastq.gz\n@PG ID:samtools PN:samtools PP:bwa  VN:1.21 CL:samtools sort\n@PG ID:samtools.1   PN:samtools PP:samtools VN:1.21 CL:samtools view -bh\n2. Alignment Record (The actual reads)\nread1  99  chr6  1000  60  76M  =  1150  226  ATGC...  ####\n\n\n\nField\nMeaning\n\n\n\n\nQNAME\nQuery / Read Name (read1)\n\n\nFLAG\nBitwise flags describing state (99)\n\n\nRNAME\nReference sequence / Chromosome (chr6)\n\n\nPOS\n1-based mapping position (1000)\n\n\nMAPQ\nMapping quality / Confidence (60)\n\n\nCIGAR\nAlignment String (76M)\n\n\nSEQ\nNucleotide sequence (ATGC...)\n\n\nQUAL\nBase quality scores (####)\n\n\n\n\n\n\n\n\n\nAdditional SAM fields in this example\n\n\n\nRNEXT = = (mate maps to same chromosome)\nPNEXT = 1150 (mate’s mapping position)\n\nTLEN = 226 (template/insert length in bp)\n\n\n\n\n\n\n\n\n\n\n\nResource\n\n\nLearn more at the SIB course:\n\nNGS - Quality Control, Alignment, Visualization\nhttps://broadinstitute.github.io/picard/explain-flags.html"
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#marking-pcr-duplicates",
    "href": "slides/02_introduction_cancer_variants.html#marking-pcr-duplicates",
    "title": "Cancer Variant Analysis",
    "section": "Marking PCR Duplicates",
    "text": "Marking PCR Duplicates\n\n\nWhy it matters:\n\nVariant callers assume each read is an independent observation\nPCR/optical duplicates violate this assumption\nCan lead to false positive variant calls\n\nSolution:\n\nMark duplicates based on alignment coordinates\nUse Unique Molecular Identifiers (UMIs) for accurate deduplication - especially important for low-input and ctDNA samples\n\nTool: gatk MarkDuplicates\n\n\n\n\nMark duplicates, Source"
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#read-groups-organizing-your-data",
    "href": "slides/02_introduction_cancer_variants.html#read-groups-organizing-your-data",
    "title": "Cancer Variant Analysis",
    "section": "Read Groups: Organizing Your Data",
    "text": "Read Groups: Organizing Your Data\nPurpose: Track metadata for groups of reads within BAM files\n\n\nKey Read Group Tags:\n\nID: Unique read group identifier\nSM: Sample name (patient/specimen)\n\nCritical for multi-sample calling\nTumor vs. Normal distinction\n\nLB: Library prep identifier\n\nUsed for duplicate marking\n\nPL: Sequencing platform\nPU: Platform unit (flowcell.lane)\n\nFor tracking batch effects\n\n\nWhy read groups matter:\n\nBQSR: Models built per-read-group\nMerging: Combine multiple lanes/runs per sample\nDuplicate marking: Per-library detection\nSomatic calling: Required to distinguish tumor/normal\nQC & troubleshooting: Track technical artifacts\n\n\nHeader Example (Tumor-Normal Pair):\nNormal:\n@RG ID:normal.lane1  SM:patient001_normal  LB:lib_n  PL:ILLUMINA  PU:HWI.lane1\n@RG ID:normal.lane2  SM:patient001_normal  LB:lib_n  PL:ILLUMINA  PU:HWI.lane2\nTumor:\n@RG ID:tumor.lane1   SM:patient001_tumor   LB:lib_t  PL:ILLUMINA  PU:HWI.lane1\n@RG ID:tumor.lane2   SM:patient001_tumor   LB:lib_t  PL:ILLUMINA  PU:HWI.lane2\nAlignment Record with Read Group:\nread1  99  chr20  1000  60  76M  =  1150  226  ATGC...  ####  RG:Z:tumor.lane1\n\n\n\nTag\nValue\nMeaning\n\n\n\n\nRG:Z:\ntumor.lane1\nLinks read to @RG ID:tumor.lane1\n\n\n\n\n\n\n\n\n\n\nSomatic Variant Calling Context\n\n\nMutect2 uses the SM: field to identify tumor and normal samples. Without proper read groups, somatic callers cannot distinguish between samples!\n\n\n\n\n\n\n\n\n\nBest Practice\n\n\nAdd read groups during alignment for efficiency:\nbwa mem -R '@RG\\tID:tumor.lane1\\tSM:patient001_tumor\\tLB:lib_t\\tPL:ILLUMINA' ref.fa reads.fq\nAvoid post-hoc addition (e.g., GATK AddOrReplaceReadGroups) when possible."
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#somatic-variant-calling-challenges",
    "href": "slides/02_introduction_cancer_variants.html#somatic-variant-calling-challenges",
    "title": "Cancer Variant Analysis",
    "section": "Somatic Variant Calling Challenges",
    "text": "Somatic Variant Calling Challenges\n\n\nGermline calling assumes:\n\nHeterozygous: ~50% VAF (typically 30-70% due to technical variation)\nHomozygous: ~100% VAF\n\nThese assumptions fail in tumors:\n\nVariable tumor purity (30-80%, which is effectively contamination by normal cells)\nClonal heterogeneity (subclones)\nCopy number alterations\nVAF can be anywhere from &lt;1% to 100%\n\nAdditional challenges:\n\nSequencing errors, alignment artifacts\nFFPE artifacts\n\nC&gt;T/G&gt;A deamination\n8-oxoG which causes the G&gt;T transversions\n\nSample contamination\n\n \n\nLet’s make an example (assuming diploid genome and CN=2)\n1. The Ideal Case Sample is 100% Tumor\nIf a mutation is heterozygous (1 of 2 alleles): \\[\\text{VAF} = \\frac{1}{2} = \\mathbf{50\\%}\\]\nTo a caller, this looks like a clear, standard germline variant.\n2. Closer to reality Sample is 40% Tumor (60% Normal)\nThe normal cells (wild type) dilute the signal. \\[\\text{VAF} = \\frac{\\text{Purity}}{2}\\] \\[\\text{VAF} = \\frac{0.40}{2} = \\mathbf{20\\%}\\]\n\n\n\n\n\n\nReal-world complications\n\n\nAneuploidy complicates this further: In real cases, copy number alterations can dramatically change expected VAF. For example, if the mutation is on a region with CN=4, the math becomes more complex.\nTumor-infiltrated controls: Matched control samples can also be tumor-infiltrated, making it sometimes impossible to distinguish true somatic variants from germline or contamination."
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#tumor-purity-ploidy-and-clonality",
    "href": "slides/02_introduction_cancer_variants.html#tumor-purity-ploidy-and-clonality",
    "title": "Cancer Variant Analysis",
    "section": "Tumor Purity, Ploidy, and Clonality",
    "text": "Tumor Purity, Ploidy, and Clonality\n\n\nKey concepts:\nTumor purity: Fraction of tumor cells in sample\nPloidy: Average copy number across genome (often &gt;2 in cancer)\nClonal variants: Present in all tumor cells\nSubclonal variants: Present in a subset of tumor cells\nVAF interpretation examples:\n\nPure tumor (100%), clonal het variant → VAF ≈ 50%\n50% purity, clonal het variant → VAF ≈ 25%\n50% purity, subclonal variant (20% of cells) → VAF ≈ 5%\n\n\n\n\n\nFish plot of clonal evolution: Panel a A case of primary and relapsed AML. Panel b A breast cancer before and after neoadjuvant aromatase inhibitor therapy. Panel c An AML with complex clonal structure and 7 timepoints, Source\n\n\n\n\n\n\n\n\n\nClinical Relevance\n\n\nSubclonal variants can become dominant after treatment selection pressure, leading to resistance."
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#variant-filtering-strategies",
    "href": "slides/02_introduction_cancer_variants.html#variant-filtering-strategies",
    "title": "Cancer Variant Analysis",
    "section": "Variant Filtering Strategies",
    "text": "Variant Filtering Strategies\nThree key considerations:\n\n\n1. Sequencing Error\n\nBase quality scores (Phred: Q30 = 1/1000 error)\nVariant allele frequency\nStrand bias\nMapping quality (ie MAPQ ≥ 20)\n\n2. Technical Artifacts\n\nPanel of Normals (PoN): Database of artifacts seen in normal samples\nSystematic errors from library prep or sequencing\nFFPE artifacts\n\n\n3. Germline Filtering\n\nCompare with matched normal\nFilter using population databases:\n\ngnomAD v4.0 (&gt;800K individuals)\n1000 Genomes Phase 3 (~2,500 individuals)\n\nCommon variants (AF &gt; 0.1%) are typically germline\n\n\n\n\n\n\n\n\ngnomAD\n\n\nThe Genome Aggregation Database contains variant frequencies essential for filtering common germline variants. Most callers (Mutect2, Strelka2) apply these filters automatically, but understanding the logic helps with troubleshooting false positives."
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#gatk-mutect2-workflow",
    "href": "slides/02_introduction_cancer_variants.html#gatk-mutect2-workflow",
    "title": "Cancer Variant Analysis",
    "section": "GATK Mutect2 Workflow",
    "text": "GATK Mutect2 Workflow\n\n\n\n\n\nflowchart TD\n    A[Tumor BAM] --&gt; C[Mutect2]\n    B[Normal BAM] --&gt; C\n    D[Panel of Normals] --&gt; C\n    E[Germline Resource] --&gt; C\n    \n    A -.-&gt; |optional| F[GetPileupSummaries]\n    E -.-&gt; F\n    F -.-&gt; G[CalculateContamination]\n    G -.-&gt; |if available| H\n    \n    C --&gt; H[FilterMutectCalls]\n    H --&gt; I[Filtered VCF]\n    I --&gt; J[VEP Annotation]\n\n\n\n\n\n\nKey features:\n\nHaplotype-aware variant calling (local assembly)\nJoint analysis of tumor-normal pairs\nIntegrated contamination estimation\nF1R2 (Forward 1st, Reverse 2nd) artifact filtering\n\n\n\n\n\n\n\nPoN vs gnomAD\n\n\n\nGermline Resource: Filters biological germline variants (universal)\nPoN: Filters technical artifacts (platform-specific)\n\nPublic PoNs exist but work best when your sequencing protocol matches theirs. When in doubt, build your own!\n\n\n\nYou can find every step’s relative script here"
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#the-vcf-file-format",
    "href": "slides/02_introduction_cancer_variants.html#the-vcf-file-format",
    "title": "Cancer Variant Analysis",
    "section": "The VCF File Format",
    "text": "The VCF File Format\nVariant Call Format Standard for storing variant data (current: v4.3)\n##fileformat=VCFv4.3\n##INFO=&lt;ID=DP,Number=1,Type=Integer,Description=\"Total Depth\"&gt;\n##INFO=&lt;ID=AF,Number=A,Type=Float,Description=\"Allele Frequency\"&gt;\n##FILTER=&lt;ID=weak_evidence,Description=\"Insufficient support\"&gt;\n##FILTER=&lt;ID=germline,Description=\"Likely germline variant\"&gt;\n##FORMAT=&lt;ID=GT,Number=1,Type=String,Description=\"Genotype\"&gt;\n##FORMAT=&lt;ID=AD,Number=R,Type=Integer,Description=\"Allelic depths (REF,ALT)\"&gt;\n##FORMAT=&lt;ID=AF,Number=A,Type=Float,Description=\"Allele Frequency\"&gt;\n#CHROM  POS     ID        REF  ALT  QUAL  FILTER  INFO        FORMAT      TUMOR       NORMAL\nchr17   7577538 rs123     G    A    .     PASS    DP=100      GT:AD:AF    0/1:70,30:0.30  0/0:50,0:0.0\nchr17   7578406 .         C    T    .     germline DP=85     GT:AD:AF    0/1:40,45:0.53  0/1:30,25:0.45\nKey columns explained:\n\nCHROM/POS: Genomic location\nREF/ALT: Reference and alternate alleles\n\nFILTER: Quality filters applied (PASS = passed all)\nFORMAT: Defines sample-specific fields\nGT: Genotype (0/0=hom ref, 0/1=het, 1/1=hom alt)\nAD: Allele depths (REF count, ALT count)\nAF: Variant Allele Frequency = ALT/(REF+ALT)\n\nExample interpretation:\nRow 1: Somatic mutation (30% VAF in tumor, 0% in normal) ✓\nRow 2: Germline variant (present in both tumor and normal) ✗\n\n\n\n\n\n\nFILTER Field\n\n\n“PASS” means the variant passed all filters, not that it’s biologically validated. Clinical decisions require orthogonal validation (Sanger, ddPCR, amplicon-seq)."
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#variant-annotation-the-critical-step",
    "href": "slides/02_introduction_cancer_variants.html#variant-annotation-the-critical-step",
    "title": "Cancer Variant Analysis",
    "section": "Variant Annotation: The Critical Step",
    "text": "Variant Annotation: The Critical Step\nAfter calling, variants need biological context:\n\n\nFunctional Annotation\n\nVEP (Ensembl) or SnpEff\nEffect prediction: missense, nonsense, splice site\nImpact assessment: SIFT, PolyPhen, CADD scores\n\nClinical Databases\n\nClinVar: Clinical significance\nCOSMIC: Cancer mutation database\nOncoKB, CIViC: Actionability\n\n\nPopulation Frequencies\n\ngnomAD, dbSNP\nFilter common germline variants\n\n\n\n\n\n\n\n\nTools\n\n\nVEP offers extensive plugin ecosystem."
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#structural-variation-detection",
    "href": "slides/02_introduction_cancer_variants.html#structural-variation-detection",
    "title": "Cancer Variant Analysis",
    "section": "Structural Variation Detection",
    "text": "Structural Variation Detection\n\n\nTypes:\n\nLarge insertions/deletions\nTranslocations\nInversions\nComplex rearrangements\n\nDetection methods:\n\nDiscordant read pairs\nSplit reads\nRead depth changes\nAssembly-based approaches\n\nTools: Manta, Tiddit, GRIDSS2, DELLY, Sniffles2 (long reads)\n\n\n\n\nSV: inversion in IGV, Source\n\n\n\n\n\n\n\n\n\nLong Reads Advantage\n\n\nLong-read sequencing (PacBio HiFi, ONT) dramatically improves structural variant detection, especially for complex rearrangements and insertions."
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#copy-number-variation-cnv",
    "href": "slides/02_introduction_cancer_variants.html#copy-number-variation-cnv",
    "title": "Cancer Variant Analysis",
    "section": "Copy Number Variation (CNV)",
    "text": "Copy Number Variation (CNV)\n\n\nCharacteristics:\n\nGains or losses of genomic segments\nFull chromosome or arm-level events common\nCan cause Loss of Heterozygosity (LOH)\n\nDetection approach:\n\nCalculate coverage in bins\nNormalize for GC content and mappability\nCompare tumor vs normal ratio\nSegment and call CNV regions\n\nTools: CNVkit, ASCAT, Control-FREEC, PURPLE\n\n\n\n\nCNV scatter pot, Source\n\n\n\n\n\n\n\n\n\nClinical Example\n\n\nERBB2 (HER2) amplification in breast cancer determines eligibility for trastuzumab. MYC amplification is prognostic in many cancers."
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#gene-fusions-in-cancer",
    "href": "slides/02_introduction_cancer_variants.html#gene-fusions-in-cancer",
    "title": "Cancer Variant Analysis",
    "section": "Gene Fusions in Cancer",
    "text": "Gene Fusions in Cancer\n\n\nMechanism:\n\nChromosomal translocation\nFusion of gene elements\nCreates chimeric transcripts\n\nDetection data types:\n\nWGS (genomic breakpoints)\nWES (if breakpoints in exons)\nRNA-seq (fusion transcripts)\n\nDetection method: Discordant alignments where paired reads map to different genes/chromosomes\nTools: Manta (DNA), STAR-Fusion, Arriba (RNA-seq)\n\n\n\n\nBCR::ABL1 fusion, Source\n\n\n\n\n\n\n\n\n\nFamous Example\n\n\nBCR-ABL fusion in CML(Chronic Myeloid Leukemia)\n\ndiscovered 1960\ntranslocation identified 1973\nimatinib approved 2001.\n\nFrom observation to targeted therapy took 41 years; today we can do this computationally."
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#quality-control-metrics",
    "href": "slides/02_introduction_cancer_variants.html#quality-control-metrics",
    "title": "Cancer Variant Analysis",
    "section": "Quality Control Metrics",
    "text": "Quality Control Metrics\nEssential QC checks at each stage:\n\n\n\n\n\n\n\n\nMetric\nExpected Value\nInterpretation\n\n\n\n\nMapping rate\n&gt;95%\nLow = contamination or poor quality\n\n\nDuplicate rate\n&lt;30% (WGS)\nHigh = low library complexity\n\n\nMean coverage\nAs specified\nLow = insufficient data\n\n\nCoverage uniformity\nCV &lt;0.2\nHigh variability = capture issues\n\n\nContamination\n&lt;1-2%\nHigh = sample swap or cross-contamination\n\n\nTi/Tv ratio\n~2.0-2.1 (WGS), ~3.0-3.3 (exome)\nLow = sequencing errors enriched\n\n\nInsert size\n200-400bp (Illumina)\nBimodal = library issues\n\n\nGC bias\nFlat across 30-70% GC\nStrong bias = PCR or coverage issues\n\n\n\nTools: fastQC, MultiQC, mosdepth, GATK CollectHsMetrics"
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#summary-and-key-takeaways",
    "href": "slides/02_introduction_cancer_variants.html#summary-and-key-takeaways",
    "title": "Cancer Variant Analysis",
    "section": "Summary and Key Takeaways",
    "text": "Summary and Key Takeaways\n\n\nCancer Genomics Fundamentals:\n\nCancer is driven by genomic alterations\nBoth small variants and structural changes\nSomatic vs germline distinction critical\n~5-10% hereditary predisposition\n\nTechnical Considerations:\n\nTumor-normal paired design\nAppropriate sequencing strategy\nQuality preprocessing essential\nPurity &gt;30% recommended\n\n\nVariant Calling:\n\nHaplotype-aware methods (Mutect2)\nMultiple filtering strategies\nStandard file formats (BAM, VCF)\nAnnotation is essential!\n\nClinical Applications:\n\nMutational signatures reveal etiology\nTMB predicts immunotherapy response\nFusions guide targeted therapy\nCNV determines treatment options"
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#references-and-resources",
    "href": "slides/02_introduction_cancer_variants.html#references-and-resources",
    "title": "Cancer Variant Analysis",
    "section": "References and Resources",
    "text": "References and Resources\nKey Papers:\n\nHanahan & Weinberg (2011) Cell - Hallmarks of Cancer\nVogelstein et al. (2013) Science - Cancer Genome Landscapes\nAlexandrov et al. (2020) Nature - Mutational Signatures\nCibulskis et al. (2013) Nature Biotech - MuTect\nKarczewski et al. (2020) Nature - gnomAD\n\nDatabases:\n\nCOSMIC (cancer.sanger.ac.uk) - Somatic mutations\ngnomAD (gnomad.broadinstitute.org) - Population frequencies\nClinVar - Clinical interpretations\nOncoKB - Precision oncology knowledge\n\nTools & Pipelines:\n\nGATK (gatk.broadinstitute.org)\nnf-core/sarek - Production pipeline\nIGV (igv.org) - Visualization"
  },
  {
    "objectID": "slides/02_introduction_cancer_variants.html#exercises",
    "href": "slides/02_introduction_cancer_variants.html#exercises",
    "title": "Cancer Variant Analysis",
    "section": "Exercises",
    "text": "Exercises\n\n\n\nGiphy"
  },
  {
    "objectID": "variant_annotation.html",
    "href": "variant_annotation.html",
    "title": "Variants annotation",
    "section": "",
    "text": "Variants annotation"
  },
  {
    "objectID": "variant_annotation.html#presentation",
    "href": "variant_annotation.html#presentation",
    "title": "Variants annotation",
    "section": "",
    "text": "Variants annotation"
  },
  {
    "objectID": "variant_annotation.html#ensembl-vep",
    "href": "variant_annotation.html#ensembl-vep",
    "title": "Variants annotation",
    "section": "Ensembl VEP",
    "text": "Ensembl VEP\nVEP is a powerful and flexible tool for annotating, analyzing, and prioritizing genomic variants. It is particularly useful in cancer genomics, where we need to understand the potential functional impact of somatic mutations for research and clinical decisions.\nWith VEP we can start to address questions such as:\n\nHow damaging is a specific somatic mutation according to reference databases?\nIs the mutation already known in this particular cancer type?\nWhat is the predicted functional impact of this mutation in the tumour context?\nAre there known associations between this mutation and specific drugs or drug classes?\nHow common the mutation is in various populations?"
  },
  {
    "objectID": "variant_annotation.html#why-do-we-need-a-tool-like-vep",
    "href": "variant_annotation.html#why-do-we-need-a-tool-like-vep",
    "title": "Variants annotation",
    "section": "Why do we need a tool like VEP?",
    "text": "Why do we need a tool like VEP?\nIn a typical cancer exome or panel we may obtain thousands of somatic SNVs and indels per sample. These variants:\n\nAre not analyzed one by one by hand.\nNeed to be standardized (same genome build, same transcript model, consistent consequence terms).\nNeed to be prioritized so that we can focus on potentially actionable or biologically relevant changes.\n\nA tool like VEP allows us to:\n\nRun high‑throughput annotation of all variants in a VCF.\nAttach consistent functional predictions and database links (ClinVar, COSMIC, etc.).\nReduce a long list of raw calls to a shorter list of interpretable candidate variants for downstream review."
  },
  {
    "objectID": "variant_annotation.html#key-concepts",
    "href": "variant_annotation.html#key-concepts",
    "title": "Variants annotation",
    "section": "Key Concepts",
    "text": "Key Concepts\n\nInstall VEP\n\n\n\n\n\n\nNoteVEP Version\n\n\n\nThis course uses VEP v115 (2025). Some features and default behaviors may differ in other versions. Always check the release notes for your version.\n\n\nVEP is already pre-installed on the cloud server. In order to load the environment, run:\nmamba activate ngs-tools\nIf you want to install VEP locally or on your compute cluster, you can follow the instructions below.\n\n\n\n\n\n\nNoteInstructions for local install\n\n\n\n\n\n# Installing Conda #https://docs.anaconda.com/miniconda/\nmkdir -p ~/miniconda3\nwget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O ~/miniconda3/miniconda.sh\nbash ~/miniconda3/miniconda.sh -b -u -p ~/miniconda3\nrm ~/miniconda3/miniconda.sh\nsource ~/miniconda3/bin/activate\nconda init --all\n\n# Using Conda\nconda create -n vep samtools python=3.10 ensembl-vep=115\n# conda install -c bioconda ensembl-vep=115 # if installing in current env\n\n# Activate VEP's env\nconda activate vep\n\n# PLEASE DO RUN During the course, only if you follow locally\n# Install all the data locally\n#vep_install -a cf -s homo_sapiens -y GRCh38 --CONVERT (this command will download in $HOME/.vep the cache folder)\n#vep_install -a cf -s homo_sapiens -y GRCh38 -c $HOME/project/course_data/vep --CONVERT (this specify the cache folder)\n\n# Plugins installation\n# vep_install -a p --PLUGINS all\nInstead of conda you could try installing mamba. If you are on Unix-based system this is simple mamba.  If you are following along the course, mamba is already installed for you, with all the software required for this course. In this case you can activate the enviroment with mamba activate ngs-tools.\n\n\n\n\n\nTranscript Selection\nVEP can report consequences for all transcripts overlapping a variant. However, this often results in multiple annotations per variant. Several approaches are available to handle this:\n\n--pick: Selects one consequence per variant based on a predefined hierarchy (e.g., HIGH &gt; MODERATE &gt; LOW &gt; MODIFIER)\n--pick_allele: Selects one consequence per variant allele\n--pick_allele_gene: Selects one consequence per variant allele per gene\n--per_gene: Selects one consequence per gene\n--flag_pick: Flags the selected consequence while retaining others\n\n\n\nConsequence Priority\nVEP ranks consequences by severity:  Figure 1: Image from the Ensembl VEP website.\n\n\n\n\n\n\n\n\nConsequence\nImpact\nDescription\n\n\n\n\nTranscript ablation\nHIGH\nComplete deletion of a gene transcript\n\n\nSplice acceptor variant\nHIGH\nVariant at the 3’ end of an intron that disrupts RNA splicing\n\n\nSplice donor variant\nHIGH\nVariant at the 5’ end of an intron that disrupts RNA splicing\n\n\nStop gained\nHIGH\nVariant that introduces a premature stop codon\n\n\nFrameshift variant\nHIGH\nInsertion/deletion causing reading frame disruption\n\n\nStop lost\nHIGH\nVariant removes stop codon, extending protein length\n\n\nStart lost\nHIGH\nLoss of start codon prevents proper translation initiation\n\n\nTranscript amplification\nHIGH\nIncreased copy number of transcript regions\n\n\nInframe insertion\nMODERATE\nInsertion of bases in multiples of 3, no frameshift\n\n\nInframe deletion\nMODERATE\nDeletion of bases in multiples of 3, no frameshift\n\n\nMissense variant\nMODERATE\nSingle nucleotide change causing amino acid substitution\n\n\nProtein altering variant\nMODERATE\nVariant changes protein sequence"
  },
  {
    "objectID": "variant_annotation.html#practical-exercises",
    "href": "variant_annotation.html#practical-exercises",
    "title": "Variants annotation",
    "section": "Practical Exercises",
    "text": "Practical Exercises\nIn case that you do not have the Mutect2 call and/or the CNVkit call, you can obtain those from here. In this folder there are also a README.md and some folders containing preprocessed data for the additional resources that we will use with Ensembl-VEP. The script that is used to download all the databases resources mentioned in the exercises is in the course repo’s scripts folder.\nIf you are following along the course you should download and extract the data into your $HOME/project/ folder.\n\n\n\n\n\n\nCaution--cache option\n\n\n\n\n\nBy default VEP will install the cache and plugins into your home folder (~/.vep/) and if that is the case, then you can leave it like --cache. - If you are following along the course, you need to change the cache folder to --cache /data/.vep or VEP will not find the local cache.\n\n\n\n\nExercise 1\n\n\n\n\n\n\nImportantBasic VEP Analysis\n\n\n\nObjective: Annotate a small VCF file and understand the basic output format.\nInput Data:\n##fileformat=VCFv4.2\n#CHROM    POS    ID    REF    ALT    QUAL    FILTER    INFO\nchr7    55242465    rs121913529    A    T    .    PASS    .\nchr17    7577121    rs28934578    C    T    .    PASS    .\nchr13    32936646    rs28897743    C    T    .    PASS    .\nchr17    7674894    rs28934574    G    A    .    PASS    .\nchr13    32914438    rs80357090    T    C    .    PASS    .\nchr17    41245466    rs28897686    G    A    .    PASS    .\nchr3    178936091    rs63751289    G    A    .    PASS    .\nchr10    89624230    rs61751507    G    A    .    PASS    .\nchr11    108098576    rs386833395    G    A    .    PASS    .\nchr4    55141055    rs1800744    A    G    .    PASS    .\nchr1    11190510    rs6603781    G    A    .    PASS    .\nchr7    140453136    rs121913530    A    T    .    PASS    .\nchr5    112175770    rs121913343    C    T    .    PASS    .\nchr17   43094464    rs28897672    A   C   .   PASS    .\nTask: Annotate these variants using VEP and identify which genes are affected.\n\n\n\n\n\n\n\n\nNoteCommand\n\n\n\n\n\nVEP can be provided with a VCF file as an input (or vcf.gz + index) file or other formats, see documentation here \nvep -i cancer_variants.vcf \\\n--cache /data/.vep \\\n--species homo_sapiens \\\n--assembly GRCh38 \\\n--offline --format vcf \\\n--symbol \\\n--force_overwrite \\\n--domains \\\n--sift b \\\n--polyphen b \\\n--output_file output.txt\n\n\n\n\n\n\n\n\n\nTipSolution\n\n\n\n\n\n\n# 0. from your terminal go to your project folder\ncd ~/project\n\n# 1. First, create a script that will generate our VCF file. \n# Copy this code (from #!/usr/bin/env bash) into a new file named `create_vcf.sh`\n# with the command `nano create_vcf.sh`:\n\n#!/usr/bin/env bash\n\necho -e '##fileformat=VCFv4.2\n##INFO=&lt;ID=AF,Number=A,Type=Float,Description=\"Allele Frequency\"&gt;\n#CHROM\\tPOS\\tID\\tREF\\tALT\\tQUAL\\tFILTER\\tINFO\nchr7\\t55242465\\trs121913529\\tA\\tT\\t.\\tPASS\\t.\nchr17\\t7577121\\trs28934578\\tC\\tT\\t.\\tPASS\\t.\nchr13\\t32936646\\trs28897743\\tC\\tT\\t.\\tPASS\\t.\nchr17\\t7674894\\trs28934574\\tG\\tA\\t.\\tPASS\\t.\nchr13\\t32914438\\trs80357090\\tT\\tC\\t.\\tPASS\\t.\nchr17\\t41245466\\trs28897686\\tG\\tA\\t.\\tPASS\\t.\nchr3\\t178936091\\trs63751289\\tG\\tA\\t.\\tPASS\\t.\nchr10\\t89624230\\trs61751507\\tG\\tA\\t.\\tPASS\\t.\nchr11\\t108098576\\trs386833395\\tG\\tA\\t.\\tPASS\\t.\nchr4\\t55141055\\trs1800744\\tA\\tG\\t.\\tPASS\\t.\nchr1\\t11190510\\trs6603781\\tG\\tA\\t.\\tPASS\\t.\nchr7\\t140453136\\trs121913530\\tA\\tT\\t.\\tPASS\\t.\nchr17\\t43094464\\trs28897672\\tA\\tC\\t.\\tPASS\\t.\nchr5\\t112175770\\trs121913343\\tC\\tT\\t.\\tPASS\\t.' &gt; cancer_variants.vcf\n\n# 2. Make the script executable:\nchmod +x create_vcf.sh\n\n# 3. Run the script:\n./create_vcf.sh\n\n# 4. Verify the file was created correctly:\n# Check the content\ncat cancer_variants.vcf\n\n# Make sure you have 13 variants\ngrep -v '^#' cancer_variants.vcf | wc -l  # it should show 14\n\n# Run VEP ~&lt; 5min\nvep -i cancer_variants.vcf \\\n    --cache /data/.vep \\\n    --species homo_sapiens \\\n    --offline \\\n    --force_overwrite \\\n    --assembly GRCh38 \\\n    --format vcf \\\n    --symbol \\\n    --sift b \\\n    --polyphen b \\\n    --pick \\\n    --domains \\\n    --output_file output.txt\n\n# Some of the variants affect:\n\n## VEP command-line: vep --assembly GRCh38 --cache /data/.vep --database 0 --force_overwrite --format vcf --input_file cancer_variants.vcf --offline --output_file output.txt --pick --symbol\n#Uploaded_variation Location    Allele  Gene    Feature Feature_type    Consequence cDNA_position   CDS_position    Protein_position    Amino_acids Codons  Existing_variation  Extra\nrs121913529 chr7:55242465   T   ENSG00000280890 ENST00000626532 Transcript  intron_variant,non_coding_transcript_variant    -   -   -   -   -   -   IMPACT=MODIFIER;STRAND=-1;SYMBOL=ELDR;SYMBOL_SOURCE=HGNC;HGNC_ID=HGNC:49511\nrs28934578  chr17:7577121   T   ENSG00000161960 ENST00000293831 Transcript  missense_variant    597 580 194 D/Y Gac/Tac -   IMPACT=MODERATE;STRAND=1;SYMBOL=EIF4A1;SYMBOL_SOURCE=HGNC;HGNC_ID=HGNC:3282\nrs28897743  chr13:32936646  T   -   -   -   intergenic_variant  -   -   -   -   -   -   IMPACT=MODIFIER\nrs28934574  chr17:7674894   A   ENSG00000141510 ENST00000269305 Transcript  stop_gained 779 637 213 R/* Cga/Tga -   IMPACT=HIGH;STRAND=-1;SYMBOL=TP53;SYMBOL_SOURCE=HGNC;HGNC_ID=HGNC:11998\nrs28897686  chr17:41245466  A   ENSG00000241595 ENST00000334109 Transcript  upstream_gene_variant   -   -   -   -   -   -   IMPACT=MODIFIER;DISTANCE=4221;STRAND=1;SYMBOL=KRTAP9-4;SYMBOL_SOURCE=HGNC;HGNC_ID=HGNC:18902\nrs28934574 from this example is a TP53 stop gained mutation commonly found in cancer.\nYou can try to run without --pick and --everything see what happens.\nHere you can see the html summary file generated:\n VEP report \n\n\n\nAfter running the command you will also notice a output.txt_summary.html that will show some statistics on the annotation process and the results visually (see solution above). If you tried running --everything or -e this is a shortcut for the following options:\n\n\n\n\n\n\nNote-e or --everything\n\n\n\n\n\n--sift b, --polyphen b, --ccds, --hgvs, --symbol, --numbers, --domains, --regulatory, --canonical, --protein, --biotype, --af, --af_1kg, --af_esp, --af_gnomade, --af_gnomadg, --max_af, --pubmed, --uniprot, --mane, --tsl, --appris, --variant_class, --gene_phenotype, --mirna \nThis an example of the highput from the TP53 mutation\n\n\n\n\n\n\n\n\nField\nValue\nDescription\n\n\n\n\nUploaded Variation\nrs28934574\ndbSNP identifier\n\n\nLocation\nchr17:7674894\nGenomic coordinates (GRCh38)\n\n\nAllele\nA\nAlternative allele\n\n\nGene\nENSG00000141510\nEnsembl gene ID for TP53\n\n\nTranscript\nENST00000455263\nEnsembl transcript ID\n\n\nFeature Type\nTranscript\nType of genomic feature affected\n\n\nConsequence\nstop_gained\nCreates premature stop codon\n\n\ncDNA Position\n770\nPosition in the cDNA\n\n\nCDS Position\n637\nPosition in the coding sequence\n\n\nProtein Position\n213\nPosition in the protein\n\n\nAmino Acids\nR/*\nChange from Arginine to stop codon\n\n\nCodons\nCga/Tga\nCodon change\n\n\nImpact\nHIGH\nSeverity of variant impact\n\n\nSymbol\nTP53\nHGNC gene symbol\n\n\nBiotype\nprotein_coding\nType of transcript\n\n\nCCDS\nCCDS45605.1\nConsensus CDS identifier\n\n\nUniProt\nP04637.305\nUniProt protein identifier\n\n\nHGVSc\nENST00000455263.6:c.637C&gt;T\nCoding sequence change in HGVS notation\n\n\nHGVSp\nENSP00000398846.2:p.Arg213Ter\nProtein change in HGVS notation\n\n\nClinical Significance\npathogenic\nClinical interpretation\n\n\ngnomAD AF\n1.368e-06\nAllele frequency in gnomAD\n\n\nMaximum AF\n1.656e-05\nMaximum allele frequency observed\n\n\n\n\n\n\nYou can have a look at the documentation to learn more about VEP’s many options here\n\n\n\n\n\n\nNoteDamage prediction tools\n\n\n\n\n\nSIFT (Sorting Intolerant From Tolerant) and PolyPhen (Polymorphism Phenotyping) are both prediction tools specifically designed to assess the functional impact of missense variants—those that result in amino acid substitutions\n\nSIFT: Based on sequence homology and physical properties of amino acids\nPolyPhen: Combines sequence-based features with structural information"
  },
  {
    "objectID": "variant_annotation.html#mutect2-results-annotation",
    "href": "variant_annotation.html#mutect2-results-annotation",
    "title": "Variants annotation",
    "section": "Mutect2 results annotation",
    "text": "Mutect2 results annotation\nThe previous section demonstrated how to run VEP and how different arguments significantly impact the output. Now, let’s apply this to a real dataset. We will take the table of somatic variants identified from the WES of chr6 and chr17 and use VEP to enrich it with functional annotations.\nExtract from the resulting Mutect2 somatic call\n##fileformat=VCFv4.2 \n#CHROM  POS     ID      REF  ALT   QUAL  FILTER  INFO \nchr17   745040    .   G   T   .   PASS\nchr17   1492466   .   C   T   .   PASS\nchr17   2364457   .   T   G   .   PASS\nchr17   3433669   .   G   T   .   PASS\nchr17   4545725   .   T   C   .   PASS\nchr17   4934441   .   G   T   .   PASS\nchr17   5007047   .   C   T   .   PASS\nchr17   7560755   .   G   A   .   PASS\nchr17   7588500   .   G   C   .   PASS\nchr6    325357    .   G   A   .   PASS\nchr6    325783    .   G   C   .   PASS\nchr6    325901    .   G   A   .   PASS\nchr6    1916336   .   G   A   .   PASS\nchr6    2674999   .   A   C   .   PASS\nchr6    2834013   .   C   G   .   PASS\nchr6    2840548   .   C   T   .   PASS\nchr6    3723708   .   C   G   .   PASS"
  },
  {
    "objectID": "variant_annotation.html#using-vep-to-annotate-mutect2-variants",
    "href": "variant_annotation.html#using-vep-to-annotate-mutect2-variants",
    "title": "Variants annotation",
    "section": "Using VEP to annotate Mutect2 variants",
    "text": "Using VEP to annotate Mutect2 variants\nThe somatic variant call can be annotated with this command\nVARIANTDIR=\"${HOME}/project/course_data/variants\"\n\nvep -i \"$VARIANTDIR\"/somatic.filtered.PASS.vcf.gz \\\n--cache /data/.vep \\\n--species homo_sapiens \\\n--assembly GRCh38 \\\n--offline \\\n--format vcf \\\n--symbol \\\n--force_overwrite \\\n--everything \\\n--output_file chr6ch17_mutect2_annotated.txt\n\n\n\n\n\n\nNote\n\n\n\nWe are using as input a vcf.gz file (which has been indexed), and we are provifing the --format vcf command, this will output by default a tsv file\n\n\n\nExercise 2\n\n\n\n\n\n\nImportantOutput to VCF\n\n\n\nWhat if the output of this file should be formatted as vcf instead? You can check VEP’s documentation here  hint: use --vcf\n\n\n\n\n\n\n\n\nTipSolution\n\n\n\n\n\nWith the option --output_file you can use vcf. After you can compress the VCF bgzip &lt;output_file.vcf&gt; and then you can index it tabix -p vcf &lt;output_file.vcf.gz&gt;. If you see VEP’s documentation there is an option to skip bgzip and instead incorporating it directly in VEP, which will be doing the compression for you --compress_output bgzip in the call. Afterwards you still need to index the file.\n\n\n\nInteresting results: We will obtain a file with many annotations.\nUploaded_variation  Location    Allele  Gene    Feature Feature_type    Consequence cDNA_position   CDS_position    Protein_position    Amino_acids Codons  Existing_variation  Extra\nchr6_1930220_GA/TT  chr6:1930220-1930221    TT  ENSG00000112699 ENST00000380815 Transcript  stop_gained 836-837 653-654 218 F/* tTC/tAA -   IMPACT=HIGH;STRAND=-1;SYMBOL=GMDS;SYMBOL_SOURCE=HGNC;HGNC_ID=HGNC:4369\n\n\n\n\n\n\n\n\n\n\n\nImpact\nGene\nLocation\nConsequence\nChange\nDetails\n\n\n\n\nHIGH\nGMDS\nchr6:1930220\nstop_gained\nF→*\nCreates premature stop codon\n\n\n\n\n\n\n\n\n\nNoteAnd other interesting variants\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nImpact\nGene\nLocation\nConsequence\nChange\nDetails\n\n\n\n\nHIGH\nSERPINB1\nchr6:2834013\nsplice_acceptor_variant\nC&gt;G\nAffects splice site\n\n\nMODERATE\nOR1E2\nchr17:3433669\nmissense_variant\nP→H\nPosition 58\n\n\nMODERATE\nPLD2\nchr17:4818362\ninframe_deletion\nVDRILK→V\n15bp deletion\n\n\nLOW\nGEMIN4\nchr17:745040\nsynonymous_variant\nL→L\nNo amino acid change\n\n\nMODIFIER\nDUSP22\nchr6:325357\nintron_variant\nG&gt;A\nWithin intron\n\n\n\n\n\n\n\n\n\n\n\n\nNotePerformance Trick\n\n\n\nCan you run the same command as before adding --fork 2, do you note any difference?\nVARIANTDIR=\"${HOME}/project/course_data/variants\"\n\nvep -i \"$VARIANTDIR/somatic.filtered.PASS.vcf.gz\" \\\n--cache /data/.vep \\\n--species homo_sapiens \\\n--assembly GRCh38 \\\n--offline \\\n--format vcf \\\n--symbol \\\n--force_overwrite \\\n--everything \\\n--fork 2 \\\n--output_file \"$VARIANTDIR/chr6ch17_mutect2_annotated.txt\"\n\n\nNow when we anaylize our output file chr6ch17_mutect2_annotated.txt in more details, there are about 160 lines and a lot of information on different transcripts that are related to the mutations found by Mutect2. Let’s say that now we would like to filter only the deleterious predictions and moderate/high impact variants. We can do that in a couple of ways:\nfilter_vep \\\n-i chr6ch17_mutect2_annotated.txt \\\n-o chr6ch17_mutect2_annotated_filtered.txt \\\n--force_overwrite \\\n--filter \"(IMPACT is HIGH or IMPACT is MODERATE) or (SIFT match deleterious or PolyPhen match probably_damaging)\"\n\n\n\n\n\n\nCaution\n\n\n\nin this line --filter \"(IMPACT is HIGH or IMPACT is MODERATE) or (SIFT match deleterious or PolyPhen match probably_damaging)\" consider that there is a difference in saying or or and as the latter is much more stringent and it would look only for variants whose prediction is in agreement.\n\n\nBut what if we want more information on the cancer mutations, can we integrate other databases to VEP? Yes we can. This can be useful prior to filtering to find additional consensus on potential interesting targets.\n\n\nExercise 3\n\n\n\n\n\n\nImportantCancer-Specific Annotation\n\n\n\nObjective: Add cancer-specific annotations using ClinVar and filter for potentially pathogenic variants.\nTask: Enhance the previous analysis by:\n\nAdding ClinVar annotations\nFiltering for HIGH/MODERATE impact variants\nCreating a summary of mutation types\n\nYou can download from here\n# Download latest ClinVar VCF\nwget https://ftp.ncbi.nlm.nih.gov/pub/clinvar/vcf_GRCh38/clinvar.vcf.gz\nwget https://ftp.ncbi.nlm.nih.gov/pub/clinvar/vcf_GRCh38/clinvar.vcf.gz.tbi\n\n\n\n\n\n\n\n\nTipSolution\n\n\n\n\n\n# Download ClinVar VCF\n\nVARIANTDIR=\"${HOME}/project/course_data/variants\"\nRESOURCEDIR=\"${HOME}/project/course_data/VEP_dbs\"\n\n# Run VEP with cancer-specific annotations\nvep -i \"$VARIANTDIR/somatic.filtered.PASS.vcf.gz\" \\\n    --cache /data/.vep \\\n    --assembly GRCh38 \\\n    --format vcf \\\n    --force_overwrite \\\n    --fork 2 \\\n    --everything \\\n    --custom \"$RESOURCEDIR\"/clinvar/clinvar.vcf.gz,ClinVar,vcf,exact,0,CLNSIG,CLNREVSTAT,CLNDN \\\n    --output_file \"$VARIANTDIR/chr6ch17_mutect2_annotated_with_clinVar.txt\"\n\n# Filter results\nfilter_vep \\\n-i \"$VARIANTDIR/chr6ch17_mutect2_annotated_with_clinVar.txt\" \\\n-o \"$VARIANTDIR/chr6ch17_mutect2_annotated_with_clinVar_filtered.txt\" \\\n--force_overwrite \\\n--filter \"(IMPACT is HIGH or IMPACT is MODERATE) or \\\n(SIFT match deleterious or PolyPhen match probably_damaging) or \\\n(ClinVar_CLNSIG match pathogenic)\"\n\n# Generate summary (using simple grep/awk commands)\necho \"Mutation Type Summary:\" &gt; summary.txt\ngrep -v \"#\" \"$VARIANTDIR/chr6ch17_mutect2_annotated_with_clinVar_filtered.txt\" | cut -f7 | sort | uniq -c &gt;&gt; \"$VARIANTDIR/summary_chr6ch17_mutect2_annotated_with_clinVar_filtered.txt\"\nThe possible values for ClinVar_CLNSIG include:\n\nPathogenic - Strong evidence the variant causes disease\nLikely_pathogenic - Evidence suggests it is probably disease-causing\nUncertain_significance (VUS) - Not enough evidence to classify either way\nLikely_benign - Evidence suggests it is probably not disease-causing\nBenign - Strong evidence the variant is not disease-causing\nConflicting_interpretations_of_pathogenicity - Different submitters disagree\nNot_provided - No interpretation was provided\nDrug_response - Affects response to medications\nOther - Other interpretations\n\n\n\n\nThe clinvar data provided us with more information coming from curated databases, and for some variants we can have multiple levels of consensus (however this is not a garantee of pathogenicity), but there are many other additional databases that one can try. However not all the databases have the same licensing, therefore each of the integrated datasets should be checked. For example COSMIC databases can be accessed only after registration, onkoKB as well.\n\n\n\n\n\n\nNote\n\n\n\nPlease do not forget to cite the data that you use and it is important to keep note of the version used. This is also an essential information for your future you!"
  },
  {
    "objectID": "variant_annotation.html#advanced-topics",
    "href": "variant_annotation.html#advanced-topics",
    "title": "Variants annotation",
    "section": "Advanced Topics",
    "text": "Advanced Topics\n\nUsing VEP Plugins\nVEP’s functionality can be extended through plugins. Here are some essential plugins for cancer analysis:\n\nREVEL: Rare Exome Variant Ensemble Learner\n\n\nREVEL paper: An Ensemble Method for Predicting the Pathogenicity of Rare Missense Variants\n\n\n\n\n\n\n\nTipREVEL\n\n\n\n\n\nREVEL\nYou can download here the data (~6.5GB): https://sites.google.com/site/revelgenomics/downloads or https://zenodo.org/records/7072866\nunzip revel-v1.3_all_chromosomes.zip\ncat revel_with_transcript_ids | tr \",\" \"\\t\" &gt; tabbed_revel.tsv\nsed '1s/.*/#&/' tabbed_revel.tsv &gt; new_tabbed_revel.tsv\nbgzip new_tabbed_revel.tsv\nPrepare for GRCh38\nzcat new_tabbed_revel.tsv.gz | head -n1 &gt; h\nzgrep -h -v ^#chr new_tabbed_revel.tsv.gz | awk '$3 != \".\" ' | sort -k1,1 -k3,3n - | cat h - | bgzip -c &gt; new_tabbed_revel_grch38.tsv.gz\ntabix -f -s 1 -b 3 -e 3 new_tabbed_revel_grch38.tsv.gz\nUsage:\n--plugin REVEL,file=/path/to/revel/data.tsv.gz\n\n\n\n\nAlphaMissense: Deep learning-based predictor\n\n\nAlphaMissense’s Paper: Accurate proteome-wide missense variant effect prediction with AlphaMissense\n\nAlphaMissense was archived on GitHub around May 2025, but it is still a gold standard, with its 216 millions predicted variants effect\n\n\n\n\n\n\nTipAlphaMissense\n\n\n\n\n\nAlphaMissense\nDownload link\nPrepare for GRCh38\nwget https://storage.googleapis.com/dm_alphamissense/AlphaMissense_hg38.tsv.gz\ntabix -s 1 -b 2 -e 2 -f -S 1 AlphaMissense_hg38.tsv.gz\nRun it with VEP\n--plugin AlphaMissense,file=/full/path/to/file.tsv.gz\n\n\n\n\nClinVar ClinVar: A curated database with mutation-&gt;disease data\n\n\nClinVar Custom Annotation: ClinVar provides curated information about relationships between variants and human health.\n\n\n\n\n\n\n\nTipClinvar\n\n\n\n\n\nDownload ClinVar for GRCh38:\nwget https://ftp.ncbi.nlm.nih.gov/pub/clinvar/vcf_GRCh38/clinvar.vcf.gz\nwget https://ftp.ncbi.nlm.nih.gov/pub/clinvar/vcf_GRCh38/clinvar.vcf.gz.tbi\nUsage with VEP:\n--custom /path/to/clinvar.vcf.gz,ClinVar,vcf,exact,0,CLNSIG,CLNREVSTAT,CLNDN\nKey fields extracted:\n\nCLNSIG: Clinical significance (Pathogenic, Benign, VUS, etc.)\nCLNREVSTAT: Review status (confidence level)\nCLNDN: Condition/disease name\n\nClinical Significance Values:\n\nPathogenic - Strong evidence the variant causes disease\nLikely_pathogenic - Evidence suggests disease-causing\nUncertain_significance (VUS) - Insufficient evidence\nLikely_benign - Evidence suggests not disease-causing\nBenign - Strong evidence variant is not disease-causing\n\n\n\n\n\n\n\n\n\n\nNoteAutomated Download Script\n\n\n\nAll three resources (REVEL, AlphaMissense, and ClinVar) can be downloaded and prepared automatically using our setup script: Download the setup script\nbash 02_download_all_VEP_dbs.sh\nThis will create the following structure:\n~/project/course_data/VEP_dbs/\n├── clinvar/\n│   ├── clinvar.vcf.gz\n│   └── clinvar.vcf.gz.tbi\n├── alphamissense/\n│   ├── AlphaMissense_hg38.tsv.gz\n│   └── AlphaMissense_hg38.tsv.gz.tbi\n└── revel/\n    ├── new_tabbed_revel_grch38.tsv.gz\n    └── new_tabbed_revel_grch38.tsv.gz.tbi\n\n\nWe have seen how to run VEP and how to filter the output. Now we can make another call on the Mutect2 output to annotate the variants using a combination of some plugins and some custom databases.\n\n\n\n\n\n\nNoteDamage prediction tools\n\n\n\n\n\n\nREVEL: An ensemble method that integrates multiple prediction tools\nAlphaMissense: Uses deep learning trained on evolutionary data\nClinVar: Provides clinical interpretations from expert curation"
  },
  {
    "objectID": "variant_annotation.html#revel-1",
    "href": "variant_annotation.html#revel-1",
    "title": "Variants annotation",
    "section": "REVEL",
    "text": "REVEL\nYou can download here the data (~6.5GB): https://sites.google.com/site/revelgenomics/downloads or https://zenodo.org/records/7072866\nunzip revel-v1.3_all_chromosomes.zip\ncat revel_with_transcript_ids | tr \",\" \"\\t\" &gt; tabbed_revel.tsv\nsed '1s/.*/#&/' tabbed_revel.tsv &gt; new_tabbed_revel.tsv\nbgzip new_tabbed_revel.tsv\nPrepare for GRCh38\nzcat new_tabbed_revel.tsv.gz | head -n1 &gt; h\nzgrep -h -v ^#chr new_tabbed_revel.tsv.gz | awk '$3 != \".\" ' | sort -k1,1 -k3,3n - | cat h - | bgzip -c &gt; new_tabbed_revel_grch38.tsv.gz\ntabix -f -s 1 -b 3 -e 3 new_tabbed_revel_grch38.tsv.gz\nUsage:\n--plugin REVEL,file=/path/to/revel/data.tsv.gz"
  },
  {
    "objectID": "variant_annotation.html#alphamissense-1",
    "href": "variant_annotation.html#alphamissense-1",
    "title": "Variants annotation",
    "section": "AlphaMissense",
    "text": "AlphaMissense\nDownload link\nPrepare for GRCh38\nwget https://storage.googleapis.com/dm_alphamissense/AlphaMissense_hg38.tsv.gz\ntabix -s 1 -b 2 -e 2 -f -S 1 AlphaMissense_hg38.tsv.gz\nRun it with VEP\n--plugin AlphaMissense,file=/full/path/to/file.tsv.gz"
  },
  {
    "objectID": "variant_annotation.html#complex-vep-annotation",
    "href": "variant_annotation.html#complex-vep-annotation",
    "title": "Variants annotation",
    "section": "Complex VEP annotation",
    "text": "Complex VEP annotation\nHere we learn how to use additional data to include additional information to the annotation\n\nEXTRA: Exercise 4\n\n\n\n\n\n\nImportantComplex VEP run\n\n\n\nObjective: Learn how to comprehensively annotate cancer variants using VEP’s advanced features, plugins, and filtering capabilities to identify potentially pathogenic variants.\nTask: Enhance the previous analysis by:\n\nAdding ClinVar annotations\nAdding REVEL annotations\nAdding AlphaMissense\nAdding population frequencies --af_gnomade (gnomAD data is included in VEP cache)\nAdding plugins (--plugin SpliceRegion, --plugin AlphaMissense, --plugin REVEL)\nFiltering for HIGH/MODERATE impact variants\n\n\n\n\n\n\n\n\n\nTipSolution\n\n\n\n\n\nVARIANTDIR=\"${HOME}/project/course_data/variants\"\nRESOURCEDIR=\"${HOME}/project/course_data/VEP_dbs\"\n\nvep -i \"$VARIANTDIR/somatic.filtered.PASS.vcf.gz\" \\\n    --cache /data/.vep \\\n    --assembly GRCh38 \\\n    --format vcf \\\n    --fork 2 \\\n    --everything \\\n    --af_gnomade \\\n    --force_overwrite \\\n    --plugin SpliceRegion \\\n    --plugin REVEL,file=\"$RESOURCEDIR/revel/new_tabbed_revel_grch38.tsv.gz\" \\\n    --plugin AlphaMissense,file=\"$RESOURCEDIR/alphamissense/AlphaMissense_hg38.tsv.gz\" \\\n    --custom \"$RESOURCEDIR/clinvar/clinvar.vcf.gz\",ClinVar,vcf,overlap,0,CLNSIG,CLNREVSTAT,CLNDN \\\n    --output_file \"$VARIANTDIR/chr6ch17_mutect2_annotated_with_clinVar_and_plugins.txt\"\n    \n# Filter the data -&gt; Stringent\nfilter_vep \\\n-i \"$VARIANTDIR/chr6ch17_mutect2_annotated_with_clinVar_and_plugins.txt\" \\\n-o \"$VARIANTDIR/stringent_filtered.txt\" \\\n--force_overwrite \\\n--filter \"(IMPACT is HIGH or IMPACT is MODERATE) and \\\n       (REVEL &gt;= 0.75 or \\\n        am_class = 'likely_pathogenic' or \\\n        SIFT = 'deleterious' and PolyPhen = 'probably_damaging')\"\n          \n# Filter the data -&gt; Moderate\nfilter_vep \\\n-i \"$VARIANTDIR/chr6ch17_mutect2_annotated_with_clinVar_and_plugins.txt\" \\\n-o \"$VARIANTDIR/moderate_filtered.txt\" \\\n--force_overwrite \\\n--filter \"(IMPACT is HIGH or IMPACT is MODERATE) and \\\n         (REVEL &gt;= 0.5 or \\\n          am_class = 'likely_pathogenic' or \\\n          SIFT = 'deleterious' or \\\n          PolyPhen = 'probably_damaging')\"\nA glimpse on the results\n\n\nVariant Details\nchr6_10801908_C/G   chr6:10801908   G   ENSG00000111837 ENST00000313243 Transcript  missense_variant    1198    815 272 R/P cGa/cCa COSV57568710    IMPACT=MODERATE;STRAND=-1;VARIANT_CLASS=SNV;SYMBOL=MAK;SYMBOL_SOURCE=HGNC;HGNC_ID=HGNC:6816;BIOTYPE=protein_coding;TSL=5;APPRIS=A1;CCDS=CCDS4516.1;ENSP=ENSP00000313021;SWISSPROT=P20794.202;TREMBL=A0A140VK28.35;UNIPARC=UPI0000001BCD;UNIPROT_ISOFORM=P20794-1;GENE_PHENO=1;SIFT=deleterious(0);PolyPhen=probably_damaging(1);EXON=8/14;DOMAINS=Gene3D:1.10.510.10,AFDB-ENSP_mappings:AF-P20794-F1,Pfam:PF00069,PROSITE_profiles:PS50011,PANTHER:PTHR24055,SMART:SM00220,Superfamily:SSF56112,CDD:cd07830;HGVSc=ENST00000313243.6:c.815G&gt;C;HGVSp=ENSP00000313021.2:p.Arg272Pro;SOMATIC=1;PHENO=1;REVEL=0.884;am_class=likely_pathogenic;am_pathogenicity=0.9946\nchr6_10801908_C/G   chr6:10801908   G   ENSG00000111837 ENST00000354489 Transcript  missense_variant    1081    815 272 R/P cGa/cCa COSV57568710    IMPACT=MODERATE;STRAND=-1;VARIANT_CLASS=SNV;SYMBOL=MAK;SYMBOL_SOURCE=HGNC;HGNC_ID=HGNC:6816;BIOTYPE=protein_coding;CANONICAL=YES;MANE=MANE_Select;MANE_SELECT=NM_001242957.3;TSL=5;APPRIS=P4;CCDS=CCDS75399.1;ENSP=ENSP00000346484;SWISSPROT=P20794.202;UNIPARC=UPI000217CBBA;UNIPROT_ISOFORM=P20794-2;GENE_PHENO=1;SIFT=deleterious(0);PolyPhen=probably_damaging(0.999);EXON=8/15;DOMAINS=Gene3D:1.10.510.10,AFDB-ENSP_mappings:AF-P20794-F1,Pfam:PF00069,PROSITE_profiles:PS50011,PANTHER:PTHR24055,SMART:SM00220,Superfamily:SSF56112,CDD:cd07830;HGVSc=ENST00000354489.7:c.815G&gt;C;HGVSp=ENSP00000346484.3:p.Arg272Pro;SOMATIC=1;PHENO=1;REVEL=0.884;am_class=likely_pathogenic;am_pathogenicity=0.9946\n\n\n\nCategory\nInformation\nDescription\n\n\n\n\nBasic Information\n\n\n\n\nGenomic Location\nchr6:10801908\nGRCh38 coordinates\n\n\nVariant Type\nSNV (C&gt;G)\nSingle nucleotide variant\n\n\nGene\nMAK\nMale Germ Cell-Associated Kinase\n\n\nImpact\nMODERATE\nVEP impact classification\n\n\n\n\n\nTranscript Effects\n\nTranscript 1 (ENST00000313243)\n\n\n\n\n\n\n\n\nFeature\nValue\nNote\n\n\n\n\nConsequence\nmissense_variant\nChanges amino acid\n\n\nProtein Change\np.Arg272Pro\nArginine to Proline\n\n\nTranscript Support\nTSL=5, APPRIS=A1\nLow transcript support level\n\n\nSIFT\ndeleterious(0)\nMaximum deleteriousness score\n\n\nPolyPhen\nprobably_damaging(1)\nMaximum damaging score\n\n\nAffected Domain\nPF00069 (Protein kinase domain)\nFunctional domain impact\n\n\n\n\n\nTranscript 2 (ENST00000354489)\n\n\n\n\n\n\n\n\nFeature\nValue\nNote\n\n\n\n\nConsequence\nmissense_variant\nChanges amino acid\n\n\nProtein Change\np.Arg272Pro\nArginine to Proline\n\n\nTranscript Status\nCANONICAL, MANE_Select\nPrincipal transcript\n\n\nSIFT\ndeleterious(0)\nMaximum deleteriousness score\n\n\nPolyPhen\nprobably_damaging(0.999)\nNear maximum damaging score\n\n\nAffected Domain\nPF00069 (Protein kinase domain)\nFunctional domain impact\n\n\n\n\n\n\nPrediction Tools\n\nREVEL score: 0.884 (&gt;0.5 considered possibly pathogenic)\nAlphaMissense:\n\nClass: likely_pathogenic\nPathogenicity score: 0.9946 (very high confidence)\n\nSpliceRegion: No splice site effects detected\nClinVar: No clinical data found in ClinVar database\nSIF: SIFT=deleterious(0)\nPolyPhen: PolyPhe=probably_damaging(1)\nIMPACT: MODERATE\n\n\n\nAdditional Annotations\n\n\n\nFeature\nValue\nDescription\n\n\n\n\nCOSMIC ID\nCOSV57568710\nCatalogued in COSMIC database\n\n\nSomatic Status\nSOMATIC=1\nConfirmed somatic variant\n\n\nPhenotype\nPHENO=1\nAssociated with phenotype\n\n\nUniProt\nP20794.202\nProtein database reference\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nAt this point we obtained a good annotated set of somatic variants. This paves the way for further analysis. For example you can add more databases to your annotation call, such as COSMIC, cancerhotspots, onkoKB etc. You can also try other plugins, depending on your biological question(s). Those can add addtional data ond possibly additional filtering options.\n\nAdd other databases\nTry additional plugins\nFind interesting genes that could be drivers in your samples\nConsider population frequency of the mutation(s) (common variants are less likely to be pathogenic)\nConsider possible drug-gene interactions\nCheck in the literature\nVisualize the results\n\n\n\n\n\n\n\n\n\nNoteEXTRA: Advanced Topic: Annotating CNVs with VEP\n\n\n\n\n\nCNV annotation is more challenging than SNV annotation because:\n\nTools like REVEL/AlphaMissense are designed for SNVs\nCNV breakpoints can be imprecise\nFunctional impact affects multiple genes\n\nFor those interested in CNV annotation, expanded materials are available in the advanced resources section."
  },
  {
    "objectID": "variant_annotation.html#variant-details",
    "href": "variant_annotation.html#variant-details",
    "title": "Variants annotation",
    "section": "Variant Details",
    "text": "Variant Details\nchr6_10801908_C/G   chr6:10801908   G   ENSG00000111837 ENST00000313243 Transcript  missense_variant    1198    815 272 R/P cGa/cCa COSV57568710    IMPACT=MODERATE;STRAND=-1;VARIANT_CLASS=SNV;SYMBOL=MAK;SYMBOL_SOURCE=HGNC;HGNC_ID=HGNC:6816;BIOTYPE=protein_coding;TSL=5;APPRIS=A1;CCDS=CCDS4516.1;ENSP=ENSP00000313021;SWISSPROT=P20794.202;TREMBL=A0A140VK28.35;UNIPARC=UPI0000001BCD;UNIPROT_ISOFORM=P20794-1;GENE_PHENO=1;SIFT=deleterious(0);PolyPhen=probably_damaging(1);EXON=8/14;DOMAINS=Gene3D:1.10.510.10,AFDB-ENSP_mappings:AF-P20794-F1,Pfam:PF00069,PROSITE_profiles:PS50011,PANTHER:PTHR24055,SMART:SM00220,Superfamily:SSF56112,CDD:cd07830;HGVSc=ENST00000313243.6:c.815G&gt;C;HGVSp=ENSP00000313021.2:p.Arg272Pro;SOMATIC=1;PHENO=1;REVEL=0.884;am_class=likely_pathogenic;am_pathogenicity=0.9946\nchr6_10801908_C/G   chr6:10801908   G   ENSG00000111837 ENST00000354489 Transcript  missense_variant    1081    815 272 R/P cGa/cCa COSV57568710    IMPACT=MODERATE;STRAND=-1;VARIANT_CLASS=SNV;SYMBOL=MAK;SYMBOL_SOURCE=HGNC;HGNC_ID=HGNC:6816;BIOTYPE=protein_coding;CANONICAL=YES;MANE=MANE_Select;MANE_SELECT=NM_001242957.3;TSL=5;APPRIS=P4;CCDS=CCDS75399.1;ENSP=ENSP00000346484;SWISSPROT=P20794.202;UNIPARC=UPI000217CBBA;UNIPROT_ISOFORM=P20794-2;GENE_PHENO=1;SIFT=deleterious(0);PolyPhen=probably_damaging(0.999);EXON=8/15;DOMAINS=Gene3D:1.10.510.10,AFDB-ENSP_mappings:AF-P20794-F1,Pfam:PF00069,PROSITE_profiles:PS50011,PANTHER:PTHR24055,SMART:SM00220,Superfamily:SSF56112,CDD:cd07830;HGVSc=ENST00000354489.7:c.815G&gt;C;HGVSp=ENSP00000346484.3:p.Arg272Pro;SOMATIC=1;PHENO=1;REVEL=0.884;am_class=likely_pathogenic;am_pathogenicity=0.9946\n\n\n\nCategory\nInformation\nDescription\n\n\n\n\nBasic Information\n\n\n\n\nGenomic Location\nchr6:10801908\nGRCh38 coordinates\n\n\nVariant Type\nSNV (C&gt;G)\nSingle nucleotide variant\n\n\nGene\nMAK\nMale Germ Cell-Associated Kinase\n\n\nImpact\nMODERATE\nVEP impact classification"
  },
  {
    "objectID": "variant_annotation.html#transcript-effects",
    "href": "variant_annotation.html#transcript-effects",
    "title": "Variants annotation",
    "section": "Transcript Effects",
    "text": "Transcript Effects\n\nTranscript 1 (ENST00000313243)\n\n\n\n\n\n\n\n\nFeature\nValue\nNote\n\n\n\n\nConsequence\nmissense_variant\nChanges amino acid\n\n\nProtein Change\np.Arg272Pro\nArginine to Proline\n\n\nTranscript Support\nTSL=5, APPRIS=A1\nLow transcript support level\n\n\nSIFT\ndeleterious(0)\nMaximum deleteriousness score\n\n\nPolyPhen\nprobably_damaging(1)\nMaximum damaging score\n\n\nAffected Domain\nPF00069 (Protein kinase domain)\nFunctional domain impact\n\n\n\n\n\nTranscript 2 (ENST00000354489)\n\n\n\n\n\n\n\n\nFeature\nValue\nNote\n\n\n\n\nConsequence\nmissense_variant\nChanges amino acid\n\n\nProtein Change\np.Arg272Pro\nArginine to Proline\n\n\nTranscript Status\nCANONICAL, MANE_Select\nPrincipal transcript\n\n\nSIFT\ndeleterious(0)\nMaximum deleteriousness score\n\n\nPolyPhen\nprobably_damaging(0.999)\nNear maximum damaging score\n\n\nAffected Domain\nPF00069 (Protein kinase domain)\nFunctional domain impact"
  },
  {
    "objectID": "variant_annotation.html#prediction-tools",
    "href": "variant_annotation.html#prediction-tools",
    "title": "Variants annotation",
    "section": "Prediction Tools",
    "text": "Prediction Tools\n\nREVEL score: 0.884 (&gt;0.5 considered possibly pathogenic)\nAlphaMissense:\n\nClass: likely_pathogenic\nPathogenicity score: 0.9946 (very high confidence)\n\nSpliceRegion: No splice site effects detected\nClinVar: No clinical data found in ClinVar database\nSIF: SIFT=deleterious(0)\nPolyPhen: PolyPhe=probably_damaging(1)\nIMPACT: MODERATE"
  },
  {
    "objectID": "variant_annotation.html#additional-annotations",
    "href": "variant_annotation.html#additional-annotations",
    "title": "Variants annotation",
    "section": "Additional Annotations",
    "text": "Additional Annotations\n\n\n\nFeature\nValue\nDescription\n\n\n\n\nCOSMIC ID\nCOSV57568710\nCatalogued in COSMIC database\n\n\nSomatic Status\nSOMATIC=1\nConfirmed somatic variant\n\n\nPhenotype\nPHENO=1\nAssociated with phenotype\n\n\nUniProt\nP20794.202\nProtein database reference"
  },
  {
    "objectID": "variant_annotation.html#tips-for-cancer-variant-analysis",
    "href": "variant_annotation.html#tips-for-cancer-variant-analysis",
    "title": "Variants annotation",
    "section": "Tips for Cancer Variant Analysis",
    "text": "Tips for Cancer Variant Analysis\n\nQuality Control\n\nFilter low-quality variants before VEP annotation\nUse matched normal samples when available (if not consider PONs)\nConsider sequencing artifacts\n\nAnnotation Strategy\n\nUse multiple prediction algorithms\nConsider tissue-specific expression\nInclude population frequencies\nAdd clinical annotations\n\nInterpretation Guidelines\n\nUse cancer-specific frameworks for somatic variants\nDocument all filtering criteria\nMaintain version control of annotation sources\n\n\n\nDatabases\n\nCOSMIC: https://cancer.sanger.ac.uk/cosmic\nClinVar: https://www.ncbi.nlm.nih.gov/clinvar/\ngnomAD: https://gnomad.broadinstitute.org/\nALFA 4: https://www.ncbi.nlm.nih.gov/snp/docs/gsr/alfa/ALFA_20250407153717/\nOncoKB: https://www.oncokb.org/\n\n\n\nDownload data to COSMIC\n\nFor COSMIC: We cannot provide those files (they require licensing), you need to register and download the files. CosmicMutantExport.tsv.gz You can register here:"
  },
  {
    "objectID": "variant_annotation.html#best-practices-from-literature",
    "href": "variant_annotation.html#best-practices-from-literature",
    "title": "Variants annotation",
    "section": "Best Practices from Literature",
    "text": "Best Practices from Literature\n\n\n\n\n\n\nNoteKey Recommendations\n\n\n\nFrom McLaren et al. (2016) - VEP Paper:\n\nUse --pick or --per_gene to manage transcript complexity\nCombine multiple prediction algorithms for consensus\nAlways document VEP version and cache version for reproducibility\n\nFor Cancer Analysis:\n\nFilter common variants (gnomAD MAF &lt; 0.01) for somatic analysis\nConsider tissue-specific expression data when available\nUse multiple evidence sources (ClinVar + COSMIC + literature)\nValidate high-priority variants with orthogonal methods\n\n\n\n\nTools and Documentation\n\nVEP Documentation: http://www.ensembl.org/info/docs/tools/vep/\nVEP GitHub: https://github.com/Ensembl/ensembl-vep\nCancer Gene Census: https://cancer.sanger.ac.uk/census\n\nRemember to:\n\nAlways verify file paths and permissions\nCheck input data format and quality\nValidate output at each step\nConsider computational resources when processing large datasets\nDocument any modifications to the pipeline"
  },
  {
    "objectID": "variant_annotation.html#quick-reference",
    "href": "variant_annotation.html#quick-reference",
    "title": "Variants annotation",
    "section": "Quick Reference",
    "text": "Quick Reference\n\n\n\n\n\n\nTipVEP Command Cheatsheet\n\n\n\n\n\nBasic annotation:\nvep -i input.vcf \\\n    --cache /data/.vep \\\n    --offline \\\n    --assembly GRCh38 \\\n    -o output.txt\nWith common options:\nvep -i input.vcf \\\n    --cache /data/.vep \\\n    --offline \\\n    --assembly GRCh38 \\\n    --everything \\\n    --fork 2 \\\n    --vcf \\\n    -o output.vcf\nFilter high-impact:\nfilter_vep -i input.txt \\\n    -o filtered.txt \\\n    --filter \"IMPACT is HIGH or IMPACT is MODERATE\"\nOutput format options:\n# Tab-separated (default, most flexible for downstream analysis)\nvep ... -o output.txt\n# OR explicitly specify tab format\nvep ... --tab -o output.txt\n\n# VCF output (standard variant format)\nvep ... --vcf -o output.vcf\n\n# Compressed VCF (saves space, ready for tabix)\nvep ... --vcf --compress_output bgzip -o output.vcf.gz\n\n# Custom tab-delimited fields (choose specific columns)\nvep ... --tab --fields \"Location,Allele,Gene,SYMBOL,Consequence,IMPACT,SIFT,PolyPhen\" \\\n    -o custom_output.txt\nCommon flags:\n\n--pick: One consequence per variant\n--per_gene: One consequence per gene\n--fork N: Use N CPU cores\n--no_stats: Skip HTML summary (faster)\n--tab: Tab-separated output (default)\n--vcf: VCF format output\n--json: Outputs to JSON format\n--fields: Choose specific output columns"
  },
  {
    "objectID": "variant_annotation.html#references",
    "href": "variant_annotation.html#references",
    "title": "Variants annotation",
    "section": "References",
    "text": "References\n\nMcLaren W, et al. The Ensembl Variant Effect Predictor. Genome Biology (2016)\nEilbeck K, et al. The Sequence Ontology: a tool for the unification of genome annotations. Genome Biology (2005)\nRichards S, et al. Standards and guidelines for the interpretation of sequence variants. Genetics in Medicine (2015)\nTerry A. Brown, et al. Genomes 5 (2023)"
  }
]